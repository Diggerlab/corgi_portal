  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 09:48:14', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 09:48:14')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"0"}
  [1m[36mCorgi::BuildVersion Load (0.3ms)[0m  [1mSELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1[0m
  Rendered /Users/daneil/APP/corgi/app/views/corgi/v1/build_versions/index.json.rabl (1.8ms)
Completed 200 OK in 89ms (Views: 60.8ms | ActiveRecord: 0.3ms)
  [1m[35m (15.6ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 09:48:14', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 09:48:14')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"2"}
  [1m[36mCorgi::BuildVersion Load (10.9ms)[0m  [1mSELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1[0m
Completed 200 OK in 14ms (Views: 1.9ms | ActiveRecord: 10.9ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('kgDu5czUFunWwmQ8DzHp', '2014-06-12 09:48:38', '2014-06-12 09:48:38', 'test@test.com', '$2a$10$1RTOIWavEtK/TajbP.AGCOTPcKxcDCWbyuBTeQLxQ0Uh34Nm8DBU6', 'user', 'pending', '2014-06-12 09:48:38')
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:38', '2014-06-12 09:48:38', 1, 20)[0m
  [1m[35mSQL (29.6ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('utc8wyyz', 1)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 09:48:38', '127.0.0.1', '2014-06-12 09:48:38', 1)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 09:48:38', '127.0.0.1', '2014-06-12 09:48:38', 1)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::FeedbacksController#index as JSON
  Parameters: {"token"=>"kgDu5czUFunWwmQ8DzHp"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'kgDu5czUFunWwmQ8DzHp' LIMIT 1
  [1m[36mCorgi::User Load (0.5ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'kgDu5czUFunWwmQ8DzHp' LIMIT 1[0m
  [1m[35mCorgi::Feedback Load (0.4ms)[0m  SELECT `corgi_feedbacks`.* FROM `corgi_feedbacks`  WHERE `corgi_feedbacks`.`user_id` = 1  ORDER BY created_at DESC
  Rendered /Users/daneil/APP/corgi/app/views/corgi/v1/feedbacks/index.json.rabl (2.8ms)
Completed 200 OK in 71ms (Views: 36.1ms | ActiveRecord: 1.3ms)
  [1m[36m (22.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('izH4sFrgoci2XZfPWC2q', '2014-06-12 09:48:44', '2014-06-12 09:48:44', 'test1@test.com', '$2a$10$FQh2rWv00XV9AppYBK0jQ.IMVtbTckB55PcvJZDxn0Mlz92N2Ovu.', 'user', 'pending', '2014-06-12 09:48:44')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:44', '2014-06-12 09:48:44', 2, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uuqkta8p', 2)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test1@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test1@test.com' LIMIT 1
Completed 500 Internal Server Error in 84ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('z1wyYcPYB4PQguscH17c', '2014-06-12 09:48:44', '2014-06-12 09:48:44', 'test2@test.com', '$2a$10$nu4RCejE6Vv5XN3eG1YDtOofzJii8jOjo9TACiUSxF2sgZLUQqzgK', 'user', 'pending', '2014-06-12 09:48:44')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:44', '2014-06-12 09:48:44', 3, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uvmveu3x', 3)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"daneil@daneil.com"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'daneil@daneil.com' LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (23.3ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('7LjqCqYBUUdXnS5V6pfU', '2014-06-12 09:48:44', '2014-06-12 09:48:44', 'test3@test.com', '$2a$10$6BPJFyQTPludLqkWKf1SluPWwPuHMEOK2DGme.PZUT9IqtJd2Gbd6', 'user', 'pending', '2014-06-12 09:48:44')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:44', '2014-06-12 09:48:44', 4, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uy4ta26z', 4)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>nil}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (43.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test4@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('UAxi7g7vh2frB5G3xGfm', '2014-06-12 09:48:44', '2014-06-12 09:48:44', 'test4@test.com', '$2a$10$ulk0yqNw/wOHehbOhLXxVOyr3kOkEld.xXyzzySf/iJVYCByLq6lO', 'user', 'pending', '2014-06-12 09:48:44')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:44', '2014-06-12 09:48:44', 5, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('unauv4ek', 5)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test4@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test4@test.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test4@test.com' AND `corgi_users`.`id` != 5) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `authentication_token` = 'GPpLhExCmxdB4odbViv7', `updated_at` = '2014-06-12 09:48:44' WHERE `corgi_users`.`id` = 5
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 115ms (Views: 35.7ms | ActiveRecord: 1.5ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('LuY69oPYWzF1Y9cJGVdT', '2014-06-12 09:48:44', '2014-06-12 09:48:44', 'test5@test.com', '$2a$10$6oMidRygkWRvllrhm7KZ/..DDMuSvIvz/zCh3G7QXYITrl0Ew3bme', 'user', 'pending', '2014-06-12 09:48:44')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:44', '2014-06-12 09:48:44', 6, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxj4p4wp', 6)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test5@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test5@test.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test5@test.com' AND `corgi_users`.`id` != 6) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `corgi_users` SET `authentication_token` = 'G6KzKj8qMcUUugB8Z6ep', `updated_at` = '2014-06-12 09:48:44' WHERE `corgi_users`.`id` = 6[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 80ms (Views: 1.7ms | ActiveRecord: 1.1ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('bLVbUTp7AcoTMGhT3UHz', '2014-06-12 09:48:44', '2014-06-12 09:48:44', 'test6@test.com', '$2a$10$7XjZKPFOEl8yDIkCTKIAIeTw6MPuu.AfZ3pci8YsTk20RpGNm696C', 'user', 'pending', '2014-06-12 09:48:44')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:45', '2014-06-12 09:48:45', 7, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u88bx93g', 7)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test6@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test6@test.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test6@test.com' AND `corgi_users`.`id` != 7) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `authentication_token` = '9ubzapcBx5sFFjRjV4Rq', `updated_at` = '2014-06-12 09:48:45' WHERE `corgi_users`.`id` = 7
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 81ms (Views: 1.1ms | ActiveRecord: 1.4ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('qvpgieEMp3tkqxKGEqJF', '2014-06-12 09:48:56', '2014-06-12 09:48:56', 'test@test.com', '$2a$10$VAdNB6EBDRC6zTnJXMctQOMFRW2VTSo6VHuEgYtRmaUj9borbVa3C', 'user', 'pending', '2014-06-12 09:48:56')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:56', '2014-06-12 09:48:56', 8, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uzr95rbc', 8)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:56', 'test@test.com', '127.0.0.1', 'finished', 'qweqweqwe', '2014-06-12 09:48:56', 8)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('xHHWvpNXphLzqj9dnRFN', '2014-06-12 09:48:56', '2014-06-12 09:48:56', 'test@test.com', '$2a$10$ZEVI0Ohilzkl5zSN1UfcK.9gWNkGe7M939S35HUShv91PLfuu/MRG', 'user', 'pending', '2014-06-12 09:48:56')[0m
  [1m[35mSQL (21.0ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:56', '2014-06-12 09:48:56', 9, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('up6gjptt', 9)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:56', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:48:56', 9)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('M4FjH3F4sLurxyHVbw3B', '2014-06-12 09:48:56', '2014-06-12 09:48:56', 'test@test.com', '$2a$10$cDVTpK2ycuxs33LgIbFPTegd635z17405RpPnOcNhnD1/2N0wZaIa', 'user', 'pending', '2014-06-12 09:48:56')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:56', '2014-06-12 09:48:56', 10, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('utdqqs65', 10)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:56', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:48:56', 10)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"password_request"=>"[FILTERED]", "change_password"=>"[FILTERED]"}
  [1m[36mCorgi::PasswordRequest Load (0.4ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 10 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test@test.com' AND `corgi_users`.`id` != 10) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$XzL8jGwxYTj/gL7/yG3PMe6aQtP1LfrPIynF5nRoJ/GfRe44p2mpy', `updated_at` = '2014-06-12 09:48:56' WHERE `corgi_users`.`id` = 10[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_password_requests` SET `state` = 'finished', `updated_at` = '2014-06-12 09:48:56' WHERE `corgi_password_requests`.`id` = 3
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 165ms (Views: 22.2ms | ActiveRecord: 2.5ms)
  [1m[35m (15.9ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('9UpVjiQriwZz4Lcztd7G', '2014-06-12 09:48:56', '2014-06-12 09:48:56', 'test@test.com', '$2a$10$Wh5k7Lm6ysGJNhfkTT3JXeI8qDtyDLb.qFxEwWhm2zU0oJXHvQpVy', 'user', 'pending', '2014-06-12 09:48:56')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:56', '2014-06-12 09:48:56', 11, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uup8pwsy', 11)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"email"=>"test@test.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (33.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:56', 'test@test.com', '0.0.0.0', 'pending', '6DQxu27a4zEpw5L6jyPs', '2014-06-12 09:48:56', 11)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m

Corgi::UserMailer#send_email: processed outbound mail in 85.0ms

Sent mail to test@test.com (12.4ms)
Date: Thu, 12 Jun 2014 17:48:56 +0800
From: yumu01@163.com
To: test@test.com
Message-ID: <53997788c12a1_2c758082dbf8682c9@daneil.local.mail>
Subject: Welcome
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
  </head>
  <body>
    <p>
      To change the password, just follow this link: http://gts.api.engine.com:3001/api/v1/password_requests/new_password/?token=6DQxu27a4zEpw5L6jyPs.
    </p>
    <p>Thanks for use  our web!</p>
  </body>
</html>
Completed 200 OK in 142ms (Views: 0.3ms | ActiveRecord: 33.9ms)
  [1m[35m (15.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('pNq1ygWNiZHwsuMJY8wY', '2014-06-12 09:48:56', '2014-06-12 09:48:56', 'test@test.com', '$2a$10$4WH1oZBTt5cpOB6R2/403OFAAT04rW/nXVofPHlhh8rzYtaT0amrW', 'user', 'pending', '2014-06-12 09:48:56')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:56', '2014-06-12 09:48:56', 12, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ut7xu7q8', 12)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (3.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('FtcRgQsk8ct5feNzzS65', '2014-06-12 09:48:56', '2014-06-12 09:48:56', 'test@test.com', '$2a$10$CXi8r3J75P8OS0Dxvimkj.jjgZb1O5cPb0sdg.V8TZQSezhv7pEkS', 'user', 'pending', '2014-06-12 09:48:56')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:57', '2014-06-12 09:48:57', 13, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u88jzzrp', 13)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:57', 'g@g.com', '127.0.0.1', 'pending', '2014-06-12 09:48:57', 13)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"password_request"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 2ms
  [1m[35m (25.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('xk3pH1RHVhPyoxTLAhuW', '2014-06-12 09:48:57', '2014-06-12 09:48:57', 'test@test.com', '$2a$10$x5k/twaOGMYEsxrM9FXyEuKcXihMbzZYDw5L9XYi1mxO59Hcp3SXC', 'user', 'pending', '2014-06-12 09:48:57')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:57', '2014-06-12 09:48:57', 14, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u4e3sud5', 14)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:57', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:48:57', 14)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qweqweqwe"}
  [1m[36mCorgi::PasswordRequest Load (0.3ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1[0m
  [1m[35mCorgi::PasswordRequest Load (0.2ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1
Completed 200 OK in 9ms (Views: 7.2ms | ActiveRecord: 0.5ms)
  [1m[36m (32.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Bf3UrpsZRzVjsFdMxa3P', '2014-06-12 09:48:57', '2014-06-12 09:48:57', 'test@test.com', '$2a$10$AuOiE0//LztRqGsMxJlqNeadrbAylk8HCp543GT1PVrS3bKuzn9a2', 'user', 'pending', '2014-06-12 09:48:57')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:48:57', '2014-06-12 09:48:57', 15, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('urcpsybp', 15)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:48:57', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:48:57', 15)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qqqqqqqq"}
  [1m[35mCorgi::PasswordRequest Load (0.3ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qqqqqqqq' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('VRyXsz9bnPN7RaRCpxrE', '2014-06-12 09:49:11', '2014-06-12 09:49:11', 'test1@email.com', '$2a$10$KbKIBN45hXRZASVLElBAC.ppJoFdXnwAGMGnLDew.5aoy2D5W1kE2', 'user', 'pending', '2014-06-12 09:49:11')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:11', '2014-06-12 09:49:11', 16, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uqrcd4bf', 16)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:11', 'sina', 'test1', '111', '111', '2014-06-12 09:49:11', 16)[0m
  [1m[35m (0.3ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('QXzfTSAs6vAW1ac4DfgW', '2014-06-12 09:49:11', '2014-06-12 09:49:11', 'test1@email.com', '$2a$10$5NAs6c8v1atQzwI2Hj6UQ.LogmDG0SMUQ1Cm1pmhrcHMXhsB2ufLO', 'user', 'pending', '2014-06-12 09:49:11')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:11', '2014-06-12 09:49:11', 17, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uzt4vrap', 17)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:11', 'sina', 'test1', '111', '111', '2014-06-12 09:49:11', 17)
  [1m[36m (39.7ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Xqr4y2ZQjgMfs7Y8ix1r', '2014-06-12 09:49:11', '2014-06-12 09:49:11', 'test1@email.com', '$2a$10$Y5/sCoGqvAarvlIzRKv03eK9GM59jz5lthxfTLsER6wLjcP6SqjdG', 'user', 'pending', '2014-06-12 09:49:11')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:11', '2014-06-12 09:49:11', 18, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('udqpfvan', 18)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:11', 'sina', 'test1', '111', '111', '2014-06-12 09:49:11', 18)[0m
  [1m[35m (39.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dy7hnqfyrdqb7qg88CnY', '2014-06-12 09:49:11', '2014-06-12 09:49:11', 'test1@email.com', '$2a$10$AXE6JJOFA2ctCNL8RdAIs.gw23FwwzTfS1H.g7k6PSUQjLlCP2PyK', 'user', 'pending', '2014-06-12 09:49:11')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:11', '2014-06-12 09:49:11', 19, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ux7e68c8', 19)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:11', 'sina', 'test1', '111', '111', '2014-06-12 09:49:11', 19)
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (21.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('wQsiMrygscrp9DsaUGaZ', '2014-06-12 09:49:11', '2014-06-12 09:49:11', 'test1@email.com', '$2a$10$0VT4qVaOe3oXmrdU.Z7RHOkvTgPWdv3ya9MeKRxUeZGK8qLCrn9cG', 'user', 'pending', '2014-06-12 09:49:11')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:12', '2014-06-12 09:49:12', 20, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u8jzea7c', 20)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:12', 'sina', 'test1', '111', '111', '2014-06-12 09:49:12', 20)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (24.9ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('sieQZyq4HssuuU5DXYe9', '2014-06-12 09:49:16', '2014-06-12 09:49:16', 'test1@email.com', '$2a$10$Dp1a69lmJm7CZe4OTrrTjOmi58MYl86VmqVIBBeA6LvVCc7eSO9u.', 'user', 'pending', '2014-06-12 09:49:16')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:16', '2014-06-12 09:49:16', 21, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u6xrpxh9', 21)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:16', 'sina', 'test1', '111', '111', '2014-06-12 09:49:16', 21)[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (23.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('YgAwYhN78gSLBZpzvt4m', '2014-06-12 09:49:17', '2014-06-12 09:49:17', 'test1@email.com', '$2a$10$AKBgB4.QRO8//kIfQLNOTe.GCIUyC4y/5pMrRflb0d84aS8Nl65.m', 'user', 'pending', '2014-06-12 09:49:17')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:17', '2014-06-12 09:49:17', 22, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u3z3rfke', 22)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:17', 'sina', 'test1', '111', '111', '2014-06-12 09:49:17', 22)
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (16.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('1exRXyipFkK3j3PCR6Wr', '2014-06-12 09:49:17', '2014-06-12 09:49:17', 'test1@email.com', '$2a$10$ZCP8/kmCxu2TnZDs/ojVNOUn7VShYQWVaf9oI3hrrHayF633vrrVS', 'user', 'pending', '2014-06-12 09:49:17')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:17', '2014-06-12 09:49:17', 23, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ujz6qwbe', 23)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:17', 'sina', 'test1', '111', '111', '2014-06-12 09:49:17', 23)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (28.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('aaxL9YMbKbY8qW5yfazy', '2014-06-12 09:49:17', '2014-06-12 09:49:17', 'test1@email.com', '$2a$10$uvpA.ymzz/T48tnvn24IiOrSmpYNJ0PSvp.dAMuBJOapX8Emk4XH.', 'user', 'pending', '2014-06-12 09:49:17')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:17', '2014-06-12 09:49:17', 24, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uvzd24dj', 24)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:17', 'sina', 'test1', '111', '111', '2014-06-12 09:49:17', 24)
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (24.6ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('nizLmAG7wJ8Lqs6isrR2', '2014-06-12 09:49:17', '2014-06-12 09:49:17', 'test1@email.com', '$2a$10$vlmXUz34tpRj7zabgtajueZXohTTmIUVfVky9hKopOxBIdT4GYoZy', 'user', 'pending', '2014-06-12 09:49:17')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:17', '2014-06-12 09:49:17', 25, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ungww4y2', 25)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:17', 'sina', 'test1', '111', '111', '2014-06-12 09:49:17', 25)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('7A5u5dS9XEMkg7EeHqpC', '2014-06-12 09:49:23', '2014-06-12 09:49:23', 'test1@email.com', '$2a$10$RIJXt3.36akCV.H2uxMI..p/HOvX642tb.DBIQ8TwxdvSoVXEc3Ym', 'user', 'pending', '2014-06-12 09:49:23')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:23', '2014-06-12 09:49:23', 26, 20)[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ue3jyfpc', 26)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:23', 'sina', 'test1', '111', '111', '2014-06-12 09:49:23', 26)[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('asrdGio4QocSLkYSpGx2', '2014-06-12 09:49:23', '2014-06-12 09:49:23', 'test1@email.com', '$2a$10$KNu5I50tOvuiTtTAQkh7/OAfx2r2g2P03LT9Pt47kelRJh2g1R6bG', 'user', 'pending', '2014-06-12 09:49:23')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:23', '2014-06-12 09:49:23', 27, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ugjc6p4n', 27)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (11.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:23', 'sina', 'test1', '111', '111', '2014-06-12 09:49:23', 27)
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('QREqU3epYUJViECyra6x', '2014-06-12 09:49:23', '2014-06-12 09:49:23', 'test1@email.com', '$2a$10$aGxPFogGKrHR9LKy4ZGg3uOuREAm11yRX6KQbSk0fYnKv7u6lEfDG', 'user', 'pending', '2014-06-12 09:49:23')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:23', '2014-06-12 09:49:23', 28, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u7hhdcwb', 28)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:23', 'sina', 'test1', '111', '111', '2014-06-12 09:49:23', 28)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('GyXy43LJ2EqrysKYGfw2', '2014-06-12 09:49:23', '2014-06-12 09:49:23', 'test1@email.com', '$2a$10$7YDPAdYN93V3BuoO6gPqPekz5Uh7bGK/2hJbt3quD9AuUeePWvVxe', 'user', 'pending', '2014-06-12 09:49:23')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:23', '2014-06-12 09:49:23', 29, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uqpda8aa', 29)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:23', 'sina', 'test1', '111', '111', '2014-06-12 09:49:23', 29)
  [1m[36m (2.4ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('4NYd7w7TFzMysDmAaEKC', '2014-06-12 09:49:23', '2014-06-12 09:49:23', 'test1@email.com', '$2a$10$hG5jqbT1b6NZyMi7nlK2Telntd7SoqdKB2EPjzraUimib4I.GJ2E6', 'user', 'pending', '2014-06-12 09:49:23')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:23', '2014-06-12 09:49:23', 30, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uy7wkr3x', 30)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:23', 'sina', 'test1', '111', '111', '2014-06-12 09:49:23', 30)[0m
  [1m[35m (2.4ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('9d8V9FFkAst5qhDZsbfY', '2014-06-12 09:49:23', '2014-06-12 09:49:23', 'test1@test.com', '$2a$10$1.o.mROmeakotifXJthgf.thh/OFDsjF.QW3NlEsU7Jo8Dztw5TPi', 'user', 'pending', '2014-06-12 09:49:23')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 31, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u36wsvcc', 31)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('YVfJobYWhqLzaZ7CpjHx', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test@test.com', '$2a$10$oEigScYCTvMoLMsd1qVeIO9L9hY6daeTRxziG4xTVte0d3KVpG03a', 'user', 'pending', '2014-06-12 09:49:24')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 32, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ust2fsh6', 32)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 118ms (Views: 34.6ms | ActiveRecord: 1.2ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('joqLCtaM3Npzuza8MsBv', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test@test.com', '$2a$10$k.NRHGIvdl.dMi69y7u0kOWHDOT2HxuFhY3rlct2Zqd.xopGYNGq2', 'user', 'pending', '2014-06-12 09:49:24')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 33, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ucd3spqm', 33)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 81ms (Views: 1.7ms | ActiveRecord: 1.3ms)
  [1m[36m (15.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('CwCjc1dKVDPzRodJN1e3', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test@test.com', '$2a$10$xLivUw9rX/g8MOA4RWVjpe8xzwI8rOsh5LKY.uXdc06.HfjPvfzgu', 'user', 'pending', '2014-06-12 09:49:24')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 34, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uyjw5eqa', 34)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 1.2ms | ActiveRecord: 1.2ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '1233.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('URX5brEUSyktA4eQQhTu', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test2@test.com', '$2a$10$Y0Z73Qm620ha3il3RP1I4O7xDHIOje.yB.PLRocs/leBWXf0hipZG', 'user', 'pending', '2014-06-12 09:49:24')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 35, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9perr7c', 35)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test2@test.com", "password"=>"[FILTERED]"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms
  [1m[35m (0.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@test.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test4@test.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('b98RGuYz3yZ2SqTMuttx', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test4@test.com', '$2a$10$Bpu1lf1tLERQuR6nrtX0Iegm1NEB2FOD6FIbQDt/vdrJ..1yo4JbO', 'user', 'pending', '2014-06-12 09:49:24')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 36, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uy6thmn8', 36)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"b98RGuYz3yZ2SqTMuttx", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'b98RGuYz3yZ2SqTMuttx' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test4@test.com' AND `corgi_users`.`id` != 36) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$tS7LiNPBsEXZG9wyBB12uefaaNHDHFus3KcpfKPIfCO9gB2NaUHOq', `updated_at` = '2014-06-12 09:49:24' WHERE `corgi_users`.`id` = 36
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 165ms (Views: 1.8ms | ActiveRecord: 1.3ms)
  [1m[35m (5.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('nyxTp4foJTSGvWqb3jyd', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test5@test.com', '$2a$10$.DOjGTq5Dg7S5sH77S2SpuJVDgogRE/2m05zH6LWYrrp3MGMXZkmK', 'user', 'pending', '2014-06-12 09:49:24')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 37, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubbfv2h3', 37)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"nyxTp4foJTSGvWqb3jyd", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'nyxTp4foJTSGvWqb3jyd' LIMIT 1
Completed 500 Internal Server Error in 75ms
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('xTAWbVSdy1fufFiSZB8a', '2014-06-12 09:49:24', '2014-06-12 09:49:24', 'test6@test.com', '$2a$10$IKRS1TOCGckzKN.F0PNUvOaUPU6JjAtpI/y/Qc3NTNS7puekXqeIe', 'user', 'pending', '2014-06-12 09:49:24')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:24', '2014-06-12 09:49:24', 38, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uz4za4tu', 38)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"xTAWbVSdy1fufFiSZB8a", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'xTAWbVSdy1fufFiSZB8a' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test6@test.com' AND `corgi_users`.`id` != 38) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$L25TSXgoeRbBNITsDPmM8eR0co/sVcxKTN.XyU6iRSXO5ZctptyMi', `updated_at` = '2014-06-12 09:49:25' WHERE `corgi_users`.`id` = 38
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 149ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[35m (14.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test7@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('x5L2zMwyR8osyXsPEkHc', '2014-06-12 09:49:25', '2014-06-12 09:49:25', 'test7@test.com', '$2a$10$Mq..Qq2c4gGH4h6mOp0ZS.PakgsiKtjfHV8Tp39jwPT0Otp2nR.zy', 'user', 'pending', '2014-06-12 09:49:25')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:25', '2014-06-12 09:49:25', 39, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u5xdnhsf', 39)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"x5L2zMwyR8osyXsPEkHc", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'x5L2zMwyR8osyXsPEkHc' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test7@test.com' AND `corgi_users`.`id` != 39) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$vnRLHfKc7WpsGppkB6O/9.NfQN1umQclqMoMutz61ErckFe6ygm.a', `updated_at` = '2014-06-12 09:49:25' WHERE `corgi_users`.`id` = 39[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 149ms (Views: 0.5ms | ActiveRecord: 1.3ms)
  [1m[36m (44.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = 'test' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$PqHRxqIpuDYYGovlf60/4eAOPplgWeb.UjgZDIa6bNi2PeWoOS4Xu@fake-email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('pMUjD6qF8gM9zGkpUge8', '2014-06-12 09:49:25', '2014-06-12 09:49:25', 'u$2a$10$PqHRxqIpuDYYGovlf60/4eAOPplgWeb.UjgZDIa6bNi2PeWoOS4Xu@fake-email.com', '$2a$10$Ojpn4wpOeFOsFt9jbb1WAeeWa9D4mnz8IYFYi2TQ2Q63UtFc5ikUy', 'user', 'pending', '2014-06-12 09:49:25')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:25', '2014-06-12 09:49:25', 40, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uzc2r88n', 40)
  [1m[36mCorgi::Authentication Load (0.5ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 40 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:25', '2014-06-12 09:50:01', 'sina', 'test', '', '2014-06-12 09:49:25', 40)
  [1m[36m (92.8ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 09:49:25', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 09:49:25')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"0"}
  [1m[36mCorgi::BuildVersion Load (0.3ms)[0m  [1mSELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1[0m
Completed 200 OK in 6ms (Views: 4.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 09:49:25', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 09:49:25')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"2"}
  [1m[36mCorgi::BuildVersion Load (0.2ms)[0m  [1mSELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1[0m
Completed 200 OK in 2ms (Views: 1.3ms | ActiveRecord: 0.2ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test8@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('6m9sRJBZ1HuGrzygsuvT', '2014-06-12 09:49:25', '2014-06-12 09:49:25', 'test8@test.com', '$2a$10$WfjAt.80dFBLDWRPXU/yUOdrv2k6TjsQh.eyo6tx9a.UL0VxfT.pW', 'user', 'pending', '2014-06-12 09:49:25')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:25', '2014-06-12 09:49:25', 41, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uy67b5ya', 41)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCorgi::UserCode Load (0.4ms)[0m  SELECT  `corgi_user_codes`.* FROM `corgi_user_codes`  WHERE `corgi_user_codes`.`user_id` = 41 LIMIT 1
  [1m[36m (15.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test9@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('uCmANqXgU2ByDLviUgzz', '2014-06-12 09:49:25', '2014-06-12 09:49:25', 'test9@test.com', '$2a$10$0Pet7X3rAh1CAbFB8buyau0r7cf.F40gPjxkV3e8kbWCyRLsgpnk2', 'user', 'pending', '2014-06-12 09:49:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:25', '2014-06-12 09:49:25', 42, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('utjphfuy', 42)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test9@test.com' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test9@test.com' AND `corgi_users`.`id` != 42) LIMIT 1
  [1m[36m (0.9ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test10@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('SF2ykmQHtb5h92v9A9Yx', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test10@test.com', '$2a$10$OA3w8sXlUfVHzZ4EzgrSV.MhBeixKNHkrcsvvKWcs8tEr0Rre4kKe', 'user', 'pending', '2014-06-12 09:49:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 43, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uyvgaq2p', 43)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test11@test.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('9nLa5xwfYTyfKcSqBsqy', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test11@test.com', '$2a$10$AdBseC8r8B5jgmJfphLoO.E7OakrcNMz9fseC2Klk5RJTowDkR0GW', 'user', 'pending', '2014-06-12 09:49:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 44, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uqtafaz3', 44)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:26', 'sina', 'test', '111', '111111111', '2014-06-12 09:49:26', 44)
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test12@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('kupNQoapqAQUCvhaxB4K', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test12@test.com', '$2a$10$2TZvB9rBDyBcQdPOLv90SOKx92tugqtx8zU6unrC/x3uPTpGT4rz.', 'user', 'pending', '2014-06-12 09:49:26')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 45, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u7224jkb', 45)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test13@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('3N78EBwewaBuKAptAyj4', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test13@test.com', '$2a$10$yULzvp1OTAfIbh0//7yLb.HumZXY.VfqbIrO.sMEQdPO43WNuL8IS', 'user', 'pending', '2014-06-12 09:49:26')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 46, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uvd39q4m', 46)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCorgi::Account Load (0.3ms)[0m  SELECT  `corgi_accounts`.* FROM `corgi_accounts`  WHERE `corgi_accounts`.`user_id` = 46 LIMIT 1
  [1m[36m (11.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test14@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('HGmRxp3z9BHoqsZhJ254', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test14@test.com', '$2a$10$zZyZn/t8Jb46fgkhNRPLr.CB1QgIVrYJnxLLO60IAGFSB53fCBeZ2', 'user', 'pending', '2014-06-12 09:49:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 47, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9nw7fes', 47)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test14@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test14@test.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test14@test.com' AND `corgi_users`.`id` != 47) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `corgi_users` SET `authentication_token` = 'M1BzLx3CPZXvdox5rYsq', `updated_at` = '2014-06-12 09:49:26' WHERE `corgi_users`.`id` = 47
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 81ms (Views: 5.7ms | ActiveRecord: 1.1ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test15@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('5Zdc4DkKHsUKP6pDiWxM', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test15@test.com', '$2a$10$5RQHNsf1pEdYdqvY1OMWQeOBbTKMZI7.kEG5LfD5qkQeHilQmhyr.', 'user', 'pending', '2014-06-12 09:49:26')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 48, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxwf6xaa', 48)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test15@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test15@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test15@test.com' AND `corgi_users`.`id` != 48) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `authentication_token` = '3TJ7SFWygix9sg54qpZS', `updated_at` = '2014-06-12 09:49:26' WHERE `corgi_users`.`id` = 48[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 77ms (Views: 1.1ms | ActiveRecord: 1.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test16@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('SxYX9yVUv9U1CFG3gxja', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test16@test.com', '$2a$10$k..2i8Gu6LDzwj510wllueX.6CxMGgM2I7QI0XZBiMSgr8oliAL6y', 'user', 'pending', '2014-06-12 09:49:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:26', '2014-06-12 09:49:26', 49, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ufgas746', 49)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test16@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test16@test.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test16@test.com' AND `corgi_users`.`id` != 49) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `corgi_users` SET `authentication_token` = 'U72ZgdvsKtcZLsY5kv3s', `updated_at` = '2014-06-12 09:49:26' WHERE `corgi_users`.`id` = 49
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 79ms (Views: 1.8ms | ActiveRecord: 1.2ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test17@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('PpiAXS4hZ1xTqeDyTTKt', '2014-06-12 09:49:26', '2014-06-12 09:49:26', 'test17@test.com', '$2a$10$gHJIOFLnP4NQ7EgrMFTbLuTIdtTeo1yK2GbDac/YHgVC443K27qGa', 'user', 'pending', '2014-06-12 09:49:26')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 50, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9qhn9jw', 50)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"daneil@daneil.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'daneil@daneil.com' LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test18@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('mp2GP8vE4xQLDZN38JVf', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test18@test.com', '$2a$10$8CvN8DvtycqhWecEpH3Lqe8W2qFZbBlVYlMH.uyOYol1bQ.mTy6w2', 'user', 'pending', '2014-06-12 09:49:27')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 51, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('utqkqd4q', 51)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>nil}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (7.3ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test19@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('GCUzcov7VeiDYvUwDedQ', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test19@test.com', '$2a$10$de.K3fAgrVOSFhrJbThY1OrtFiUqn.PS1Rz.gdQxCFB1BQJAd9aNa', 'user', 'pending', '2014-06-12 09:49:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 52, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwwpqc4m', 52)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test19@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test19@test.com' LIMIT 1
Completed 500 Internal Server Error in 73ms
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dsyHJaD776h1DQ1jpwGo', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$jTRkDMWQ0PUevXMFh1oSU.LpAJeFoVnLxC76RBj4ridFOq/NvxhRW', 'user', 'pending', '2014-06-12 09:49:27')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 53, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('usgupmr7', 53)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 09:49:27', '127.0.0.1', '2014-06-12 09:49:27', 53)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 09:49:27', '127.0.0.1', '2014-06-12 09:49:27', 53)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::FeedbacksController#index as JSON
  Parameters: {"token"=>"dsyHJaD776h1DQ1jpwGo"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'dsyHJaD776h1DQ1jpwGo' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'dsyHJaD776h1DQ1jpwGo' LIMIT 1
  [1m[36mCorgi::Feedback Load (0.4ms)[0m  [1mSELECT `corgi_feedbacks`.* FROM `corgi_feedbacks`  WHERE `corgi_feedbacks`.`user_id` = 53  ORDER BY created_at DESC[0m
Completed 200 OK in 22ms (Views: 16.5ms | ActiveRecord: 0.9ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yxBppqvZ3BHh8tt3dNTp', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$jiQkK6gk1wsZcpkA0gFv7.VvFckbsqr9ufgz44xV/s9RET4gbYCAK', 'user', 'pending', '2014-06-12 09:49:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 54, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ux235f3z', 54)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"email"=>"test@test.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:27', 'test@test.com', '0.0.0.0', 'pending', '9nq2X2Hfv9LUAsWY1pXW', '2014-06-12 09:49:27', 54)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m

Corgi::UserMailer#send_email: processed outbound mail in 34.5ms

Sent mail to test@test.com (9.5ms)
Date: Thu, 12 Jun 2014 17:49:27 +0800
From: yumu01@163.com
To: test@test.com
Message-ID: <539977a787158_2ca58082dbf842298@daneil.local.mail>
Subject: Welcome
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
  </head>
  <body>
    <p>
      To change the password, just follow this link: http://gts.api.engine.com:3001/api/v1/password_requests/new_password/?token=9nq2X2Hfv9LUAsWY1pXW.
    </p>
    <p>Thanks for use  our web!</p>
  </body>
</html>
Completed 200 OK in 54ms (Views: 0.5ms | ActiveRecord: 0.8ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('qcctxd4Z9EHhf2aPbhSF', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$Fk88qxi259XZmgCDf/EVbOmFemWxWfRTEi7IK4Xz3b3BskMp3kPIa', 'user', 'pending', '2014-06-12 09:49:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 55, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('umj6f9ac', 55)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('t5XekbEiWg9dh6kfoxyG', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$2.NoLIB/qqu99qI3lRQbF.nLUj4zeWbAZ07SgS0yyZKOux/RCc9V6', 'user', 'pending', '2014-06-12 09:49:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 56, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('urd8s5mb', 56)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:27', 'g@g.com', '127.0.0.1', 'pending', '2014-06-12 09:49:27', 56)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"password_request"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('LYf14o8sib7SP5mV46ux', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$YVup74lF9ZpYGZPzGG1h9eStNJUfmrrBOKPcjhxlEsTO0mMJ8Br82', 'user', 'pending', '2014-06-12 09:49:27')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 57, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uu5qh9yx', 57)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:27', 'test@test.com', '127.0.0.1', 'finished', 'qweqweqwe', '2014-06-12 09:49:27', 57)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[36m (8.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('VUaAn6DviTr74p13GS6Q', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$lZP.Uskq/YxnVktrYke1eOwSJ0H/QH16Hjt8uDpx2D5ZuV1YNU70S', 'user', 'pending', '2014-06-12 09:49:27')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:27', '2014-06-12 09:49:27', 58, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u4hhemtd', 58)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:27', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:49:27', 58)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zyz9xW6gPt2CrmRzcppn', '2014-06-12 09:49:27', '2014-06-12 09:49:27', 'test@test.com', '$2a$10$dvirYjMLAr7c6B2XEmJe6u22WBSK7Qpsp3iZ/rZCMftXD3kESIEPC', 'user', 'pending', '2014-06-12 09:49:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:28', '2014-06-12 09:49:28', 59, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uu99un9q', 59)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:28', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:49:28', 59)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"password_request"=>"[FILTERED]", "change_password"=>"[FILTERED]"}
  [1m[36mCorgi::PasswordRequest Load (0.3ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 59 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test@test.com' AND `corgi_users`.`id` != 59) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$8XWsMTmHZGJN9qlUWofB5Oz77rQl6Mxcl7wBMmjpQk3q4c2XEHiT2', `updated_at` = '2014-06-12 09:49:28' WHERE `corgi_users`.`id` = 59[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_password_requests` SET `state` = 'finished', `updated_at` = '2014-06-12 09:49:28' WHERE `corgi_password_requests`.`id` = 12
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 83ms (Views: 0.3ms | ActiveRecord: 2.0ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Ry17rYSwnqPyxFPr9zx6', '2014-06-12 09:49:28', '2014-06-12 09:49:28', 'test@test.com', '$2a$10$FHilvUHLMsKZG/9.v7sPheY/mR7CQqnXMPM54uIxvHVkEbnRYmlAK', 'user', 'pending', '2014-06-12 09:49:28')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:28', '2014-06-12 09:49:28', 60, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('useskysr', 60)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:28', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:49:28', 60)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qweqweqwe"}
  [1m[36mCorgi::PasswordRequest Load (0.3ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1[0m
  [1m[35mCorgi::PasswordRequest Load (0.2ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.5ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('KHumBUXfssgenZN25XPH', '2014-06-12 09:49:28', '2014-06-12 09:49:28', 'test@test.com', '$2a$10$vG5lQ18uc.dxr2GJ6nVoJujuWwwGcKqzhQZSP49zaW06pDy.idCEa', 'user', 'pending', '2014-06-12 09:49:28')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:49:28', '2014-06-12 09:49:28', 61, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9ktx4et', 61)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:49:28', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 09:49:28', 61)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qqqqqqqq"}
  [1m[35mCorgi::PasswordRequest Load (0.4ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qqqqqqqq' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (13.3ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dRmMpxEC9LpsHgxc65Dm', '2014-06-12 09:51:29', '2014-06-12 09:51:29', 'test1@email.com', '$2a$10$6q7PS/lQYcmigmcvErmx9uzzWJu/Nf03im.Q6cH8xlZyMXM9ryHuK', 'user', 'pending', '2014-06-12 09:51:29')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:29', '2014-06-12 09:51:29', 62, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u76r8a99', 62)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:30', 'sina', 'test1', '111', '111', '2014-06-12 09:51:30', 62)[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('qcFJmGH4zsFqpTpEAddz', '2014-06-12 09:51:30', '2014-06-12 09:51:30', 'test1@email.com', '$2a$10$s45j/18Xkqi4VfQuUnPF3u/7tNnxkCNDjFIXLid.2F2pKmZc4kV2.', 'user', 'pending', '2014-06-12 09:51:30')[0m
  [1m[35mSQL (17.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:30', '2014-06-12 09:51:30', 63, 20)
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ujqm345q', 63)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:30', 'sina', 'test1', '111', '111', '2014-06-12 09:51:30', 63)
  [1m[36m (1.3ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('BRAy4snuUq5piu4XmRQk', '2014-06-12 09:51:30', '2014-06-12 09:51:30', 'test1@email.com', '$2a$10$rtWuhtjTjYUezqqjUVtZWe3jAR5xMh7aCIxNFSWdQXx1zIQLh.7b2', 'user', 'pending', '2014-06-12 09:51:30')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:30', '2014-06-12 09:51:30', 64, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u8xukqd7', 64)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:30', 'sina', 'test1', '111', '111', '2014-06-12 09:51:30', 64)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('5hxuSMUftNTBoPv9CPpW', '2014-06-12 09:51:30', '2014-06-12 09:51:30', 'test1@email.com', '$2a$10$kTX1wltnHdkO7EgqzJu1kOdPaXal7szk58YkES8WLB3RRFeaDz1WK', 'user', 'pending', '2014-06-12 09:51:30')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:30', '2014-06-12 09:51:30', 65, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u6cyj7k6', 65)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:30', 'sina', 'test1', '111', '111', '2014-06-12 09:51:30', 65)
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('qAUre2fyEySmMSbN7Ezk', '2014-06-12 09:51:30', '2014-06-12 09:51:30', 'test1@email.com', '$2a$10$5KN7cE7fU9cUaMZxUM/irOV3oXvFDO4aKGKej7DIxuBN1SPgthlVy', 'user', 'pending', '2014-06-12 09:51:30')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:30', '2014-06-12 09:51:30', 66, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxh3js66', 66)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:30', 'sina', 'test1', '111', '111', '2014-06-12 09:51:30', 66)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('WpJP7iYvEjEvH3MAbznb', '2014-06-12 09:51:35', '2014-06-12 09:51:35', 'test1@email.com', '$2a$10$S2wIIKIYEMoPM5c8oWoTCePNBNvMn9weQhbTAG7WEZyramkjT29qW', 'user', 'pending', '2014-06-12 09:51:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:35', '2014-06-12 09:51:35', 67, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ukq38hmw', 67)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:35', 'sina', 'test1', '111', '111', '2014-06-12 09:51:35', 67)[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (24.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('VGU48fXq9sTE9GGjR2o1', '2014-06-12 09:51:35', '2014-06-12 09:51:35', 'test1@email.com', '$2a$10$c.56nKCSxt72PQgN44Zttef9SGNWg4SexYs/HAP8iXHKrAk3UVKOW', 'user', 'pending', '2014-06-12 09:51:35')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:35', '2014-06-12 09:51:35', 68, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('usq8epx9', 68)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:35', 'sina', 'test1', '111', '111', '2014-06-12 09:51:35', 68)
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('XRXyGScWCRzVm3NsvGUq', '2014-06-12 09:51:35', '2014-06-12 09:51:35', 'test1@email.com', '$2a$10$guasoxK2cqArHWbB2eZ0A.jV4/4tyWbK5GZGvf9/Pyb3pFLxz1r6i', 'user', 'pending', '2014-06-12 09:51:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:35', '2014-06-12 09:51:35', 69, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('umvb7g35', 69)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:35', 'sina', 'test1', '111', '111', '2014-06-12 09:51:35', 69)[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('y9GwpoJxu8uLmnfsaaP2', '2014-06-12 09:51:35', '2014-06-12 09:51:35', 'test1@email.com', '$2a$10$pb.MJgrjOhUoqz6DGkCWKO07bQ8Id08i/2Npez9E93m5G/7IV1vvq', 'user', 'pending', '2014-06-12 09:51:35')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:35', '2014-06-12 09:51:35', 70, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uw7vwxbu', 70)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:35', 'sina', 'test1', '111', '111', '2014-06-12 09:51:35', 70)
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('R9qLZTWnzDQBE8ayzuza', '2014-06-12 09:51:35', '2014-06-12 09:51:35', 'test1@email.com', '$2a$10$ZZVlY0CzwIRf88Pai/xCi.Nxrwd3lvicvqQhOkrPB5dzDKluFHoZq', 'user', 'pending', '2014-06-12 09:51:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:51:35', '2014-06-12 09:51:35', 71, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxshhwqq', 71)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:51:35', 'sina', 'test1', '111', '111', '2014-06-12 09:51:35', 71)[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('uqfrSdfukycGxnmooVy6', '2014-06-12 09:53:44', '2014-06-12 09:53:44', 'test1@email.com', '$2a$10$c700puwkVJLtuLEFwftC/OZ8MPDg/MdM7Irc0V835.rxGvR/UCH/e', 'user', 'pending', '2014-06-12 09:53:44')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:44', '2014-06-12 09:53:44', 72, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u93fexrt', 72)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:44', 'sina', 'test1', '111', '111', '2014-06-12 09:53:44', 72)[0m
  [1m[35mCorgi::Authentication Load (2.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 28 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 72 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (23.2ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (28, '2014-06-12 09:53:44', 28, '111', 72, 'sina', 'connected', '111', '2014-06-12 09:53:44', 72)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.5ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 72 LIMIT 1
  [1m[36mSQL (28.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (28, '2014-06-12 09:53:44', 28, '111', 72, 'sina', 'matched', '111', '2014-06-12 09:53:44', 72)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 1244ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('EWXTWqMjcunYTwsGksp9', '2014-06-12 09:53:45', '2014-06-12 09:53:45', 'test1@email.com', '$2a$10$KZG0BdzqtM16ffqj2v.q8um81HUPqIB57tnw0drM0VaxX23k2EOR2', 'user', 'pending', '2014-06-12 09:53:45')[0m
  [1m[35mSQL (11.0ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:46', '2014-06-12 09:53:46', 73, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u5jsz329', 73)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:46', 'sina', 'test1', '111', '111', '2014-06-12 09:53:46', 73)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 29 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 73 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.6ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.3ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (29, '2014-06-12 09:53:46', 29, '111', 73, 'sina', 'connected', '111', '2014-06-12 09:53:46', 73)[0m
  [1m[35mSQL (0.3ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 73 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (29, '2014-06-12 09:53:46', 29, '111', 73, 'sina', 'matched', '111', '2014-06-12 09:53:46', 73)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$LbjJaMezQrouaqS2GnoRK..0JYUfT11VwKYdQqPTke7ChgnBWeJPi@fake-email.com' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('3LMeH8zyyVPHWysVYjWo', '2014-06-12 09:53:47', '2014-06-12 09:53:47', 'u$2a$10$LbjJaMezQrouaqS2GnoRK..0JYUfT11VwKYdQqPTke7ChgnBWeJPi@fake-email.com', '$2a$10$qI1JIG55yVif6QgRPp69KOub1MDLi7vv5cXs7.RumLXLDAn2NyPI6', 'user', 'pending', '2014-06-12 09:53:47')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:47', '2014-06-12 09:53:47', 74, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwbkaxp6', 74)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 74 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:47', '2014-06-12 09:55:50', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 09:53:47', 74)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 30 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 74 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (42.7ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (30, '2014-06-12 09:53:47', 29, '111', 73, 'sina', 'connected', '5048115199', '2014-06-12 09:53:47', 74)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 73 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (29, '2014-06-12 09:53:47', 30, '5048115199', 74, 'sina', 'matched', '111', '2014-06-12 09:53:47', 73)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1789ms
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Xokr6cz2tia3sTuAUfJ4', '2014-06-12 09:53:47', '2014-06-12 09:53:47', 'test1@email.com', '$2a$10$n0iAO8BCOTs7..2xU6f71u68lfdpednJs3n97IhymxNwrlVsFTb.6', 'user', 'pending', '2014-06-12 09:53:47')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:47', '2014-06-12 09:53:47', 75, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u2h2xrru', 75)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:47', 'sina', 'test1', '111', '111', '2014-06-12 09:53:47', 75)
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 31 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 75 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (31, '2014-06-12 09:53:47', 31, '111', 75, 'sina', 'connected', '111', '2014-06-12 09:53:47', 75)[0m
  [1m[35mSQL (0.3ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 75 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (31, '2014-06-12 09:53:47', 31, '111', 75, 'sina', 'matched', '111', '2014-06-12 09:53:47', 75)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends`
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$UbrCbE6feYl9jSWEjxYfm.7JGC/tjhMeNzTtHCh0QAtVCiF35abdC@fake-email.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('T77Rf2jhk3DpjG6XqfXC', '2014-06-12 09:53:49', '2014-06-12 09:53:49', 'u$2a$10$UbrCbE6feYl9jSWEjxYfm.7JGC/tjhMeNzTtHCh0QAtVCiF35abdC@fake-email.com', '$2a$10$D4Ztghwt8Ks40rTqbgiq3ePscmD.XZt6HDNejda.PvbTG3cfxoxzG', 'user', 'pending', '2014-06-12 09:53:49')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:49', '2014-06-12 09:53:49', 76, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('um5x8cby', 76)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 76 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:49', '2014-06-12 09:55:52', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 09:53:49', 76)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 32 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 76 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (32, '2014-06-12 09:53:49', 31, '111', 75, 'sina', 'connected', '5048115199', '2014-06-12 09:53:49', 76)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 75 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (31, '2014-06-12 09:53:49', 32, '5048115199', 76, 'sina', 'matched', '111', '2014-06-12 09:53:49', 75)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 1659ms
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yNf6VyWzghy6hTMzcVxZ', '2014-06-12 09:53:49', '2014-06-12 09:53:49', 'test1@email.com', '$2a$10$VOV7fxeIXFlyFx5vcqAUw.fsEyAD9.lK9oQhdN4/V7jugyNArhNAK', 'user', 'pending', '2014-06-12 09:53:49')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:49', '2014-06-12 09:53:49', 77, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwdm6c7r', 77)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:49', 'sina', 'test1', '111', '111', '2014-06-12 09:53:49', 77)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 33 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 77 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (33, '2014-06-12 09:53:49', 33, '111', 77, 'sina', 'connected', '111', '2014-06-12 09:53:49', 77)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 77 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (33, '2014-06-12 09:53:49', 33, '111', 77, 'sina', 'matched', '111', '2014-06-12 09:53:49', 77)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"weibo_access_token"=>"396E3E0FBFB2635428F4CAEAD986F1B8", "client_id"=>"100330589", "open_id"=>"049005BE2B6A55FEF9E95D08E22DCF58", "expires_in_sec"=>"123"}
Completed 401 Unauthorized in 1248ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[36m (5.9ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('3xZm5r4KKezoQwTCGxw3', '2014-06-12 09:53:51', '2014-06-12 09:53:51', 'test1@email.com', '$2a$10$I9suMS09raOXhXPaRdyCG.uHkby/.n5gD5RmR4O3MAH/Lj3D4tmR.', 'user', 'pending', '2014-06-12 09:53:51')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:53:51', '2014-06-12 09:53:51', 78, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxevd56w', 78)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:53:51', 'sina', 'test1', '111', '111', '2014-06-12 09:53:51', 78)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 34 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 78 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (34, '2014-06-12 09:53:51', 34, '111', 78, 'sina', 'connected', '111', '2014-06-12 09:53:51', 78)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 78 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (34, '2014-06-12 09:53:51', 34, '111', 78, 'sina', 'matched', '111', '2014-06-12 09:53:51', 78)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 1407ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('4oNF9TNURobCxVh2wNiu', '2014-06-12 09:58:30', '2014-06-12 09:58:30', 'test1@email.com', '$2a$10$YI14eHq/0aht6nh3Av0YX.og.gklqRxEcnxbwxoWBIpMkIHNCY/oW', 'user', 'pending', '2014-06-12 09:58:30')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:30', '2014-06-12 09:58:30', 79, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('upcf7886', 79)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:30', 'sina', 'test1', '111', '111', '2014-06-12 09:58:30', 79)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 35 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 79 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.6ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (35, '2014-06-12 09:58:30', 35, '111', 79, 'sina', 'connected', '111', '2014-06-12 09:58:30', 79)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 79 LIMIT 1
  [1m[36mSQL (5.5ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (35, '2014-06-12 09:58:30', 35, '111', 79, 'sina', 'matched', '111', '2014-06-12 09:58:30', 79)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$QC88PqCClsdNW0i4Lk8nBeBtpi4ABts2FCDZry2O94rw60zSPTVR6@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('oAVddUsqdsaGyAzswnZC', '2014-06-12 09:58:36', '2014-06-12 09:58:36', 'u$2a$10$QC88PqCClsdNW0i4Lk8nBeBtpi4ABts2FCDZry2O94rw60zSPTVR6@fake-email.com', '$2a$10$fwjyosRLCHCMEmgvmpCPPOjTUOd.BYw/3Bx33IXw/uNvvNN.xXhv2', 'user', 'pending', '2014-06-12 09:58:36')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:36', '2014-06-12 09:58:36', 80, 20)
  [1m[36mSQL (46.4ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ur7mydc8', 80)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 80 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:36', '2014-06-12 10:00:39', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 09:58:36', 80)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 36 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 80 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (36, '2014-06-12 09:58:36', 35, '111', 79, 'sina', 'connected', '5048115199', '2014-06-12 09:58:36', 80)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 79 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (35, '2014-06-12 09:58:36', 36, '5048115199', 80, 'sina', 'matched', '111', '2014-06-12 09:58:36', 79)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 5918ms
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('cD8ZsLNGP4q6xTvPfxw4', '2014-06-12 09:58:36', '2014-06-12 09:58:36', 'test1@email.com', '$2a$10$RtUO3vfFMxHXkDo8sNSkw./t/Gk2WgArm2koo676M1jsZJ8BKaerW', 'user', 'pending', '2014-06-12 09:58:36')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:36', '2014-06-12 09:58:36', 81, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uqa43m3k', 81)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:36', 'sina', 'test1', '111', '111', '2014-06-12 09:58:36', 81)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 37 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 81 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (37, '2014-06-12 09:58:36', 37, '111', 81, 'sina', 'connected', '111', '2014-06-12 09:58:36', 81)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 81 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (37, '2014-06-12 09:58:36', 37, '111', 81, 'sina', 'matched', '111', '2014-06-12 09:58:36', 81)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$NUfl3vQmsAsHdBqEUikOVuoQsp6jF6hBU5zPE8vwusIrxN66sUrMy@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('S2Cyy5zdsVBcfLBimw7S', '2014-06-12 09:58:38', '2014-06-12 09:58:38', 'u$2a$10$NUfl3vQmsAsHdBqEUikOVuoQsp6jF6hBU5zPE8vwusIrxN66sUrMy@fake-email.com', '$2a$10$jFwld6FsX2.MYiCZ770gleMgVL6GeEAaiqE4sOu3lh1vbd8ndYW0q', 'user', 'pending', '2014-06-12 09:58:38')[0m
  [1m[35mSQL (39.1ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:38', '2014-06-12 09:58:38', 82, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('urhvphmq', 82)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 82 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:38', '2014-06-12 10:00:41', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 09:58:38', 82)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 38 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 82 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (38, '2014-06-12 09:58:38', 37, '111', 81, 'sina', 'connected', '5048115199', '2014-06-12 09:58:38', 82)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 81 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (37, '2014-06-12 09:58:38', 38, '5048115199', 82, 'sina', 'matched', '111', '2014-06-12 09:58:38', 81)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1385ms
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Z2yVhG7AbFYY4R5tr9hE', '2014-06-12 09:58:38', '2014-06-12 09:58:38', 'test1@email.com', '$2a$10$X2tOl8kmSx7clnm80zEjgO5cZLr1gNqFCa3/xO30e3iGATK6OKx0e', 'user', 'pending', '2014-06-12 09:58:38')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:38', '2014-06-12 09:58:38', 83, 20)
  [1m[36mSQL (45.5ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ux3wqddt', 83)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:38', 'sina', 'test1', '111', '111', '2014-06-12 09:58:38', 83)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 39 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 83 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (39, '2014-06-12 09:58:38', 39, '111', 83, 'sina', 'connected', '111', '2014-06-12 09:58:38', 83)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 83 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (39, '2014-06-12 09:58:38', 39, '111', 83, 'sina', 'matched', '111', '2014-06-12 09:58:38', 83)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 1253ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('pwwfRKdpZk3fuySjc7Rx', '2014-06-12 09:58:39', '2014-06-12 09:58:39', 'test1@email.com', '$2a$10$dhiLvabpqr5LUX4QAp5vgeWtNDn1vJWKnptYh3up5UqYTv1hwPxS.', 'user', 'pending', '2014-06-12 09:58:39')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:39', '2014-06-12 09:58:39', 84, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('up3dseuk', 84)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (34.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:39', 'sina', 'test1', '111', '111', '2014-06-12 09:58:39', 84)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 40 LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 84 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (40, '2014-06-12 09:58:39', 40, '111', 84, 'sina', 'connected', '111', '2014-06-12 09:58:39', 84)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 84 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (40, '2014-06-12 09:58:39', 40, '111', 84, 'sina', 'matched', '111', '2014-06-12 09:58:39', 84)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"weibo_access_token"=>"396E3E0FBFB2635428F4CAEAD986F1B8", "client_id"=>"100330589", "open_id"=>"049005BE2B6A55FEF9E95D08E22DCF58", "expires_in_sec"=>"123"}
Completed 401 Unauthorized in 911ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[36m (30.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('44tuc5xg1ebWa6qbrsop', '2014-06-12 09:58:40', '2014-06-12 09:58:40', 'test1@email.com', '$2a$10$d3X.aW48xk/iZtJjHMUSxuuv/cDSntnD7nTAbVPtXf9UTgQaniL/.', 'user', 'pending', '2014-06-12 09:58:40')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:58:40', '2014-06-12 09:58:40', 85, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uusbmyjb', 85)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:58:40', 'sina', 'test1', '111', '111', '2014-06-12 09:58:40', 85)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 41 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 85 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (41, '2014-06-12 09:58:40', 41, '111', 85, 'sina', 'connected', '111', '2014-06-12 09:58:40', 85)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 85 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (41, '2014-06-12 09:58:40', 41, '111', 85, 'sina', 'matched', '111', '2014-06-12 09:58:40', 85)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 985ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dpy4q4GzvyiVvA7jaWyP', '2014-06-12 09:59:31', '2014-06-12 09:59:31', 'test1@email.com', '$2a$10$mihpC6SNn.MRgeXAlhetIuYgld1RTCwggzXimxDAAdmuia6xxfzbS', 'user', 'pending', '2014-06-12 09:59:31')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:31', '2014-06-12 09:59:31', 86, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uts6qmud', 86)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:31', 'sina', 'test1', '111', '111', '2014-06-12 09:59:31', 86)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 42 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 86 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (42, '2014-06-12 09:59:31', 42, '111', 86, 'sina', 'connected', '111', '2014-06-12 09:59:31', 86)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 86 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (42, '2014-06-12 09:59:31', 42, '111', 86, 'sina', 'matched', '111', '2014-06-12 09:59:31', 86)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$eDgB6lRVZtjj2YzbnOGG1eWORJJj7/tBJNR5Do9F5vJSwd87V9ZYO@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('mpMk4xWSd9F3HkNggmwn', '2014-06-12 09:59:33', '2014-06-12 09:59:33', 'u$2a$10$eDgB6lRVZtjj2YzbnOGG1eWORJJj7/tBJNR5Do9F5vJSwd87V9ZYO@fake-email.com', '$2a$10$KYz/Xae2n.0rmGTe1SdBJOXkkD2.tQimibHt9WRsS8EvWAART5QmS', 'user', 'pending', '2014-06-12 09:59:33')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:33', '2014-06-12 09:59:33', 87, 20)
  [1m[36mSQL (17.0ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uh4nktcm', 87)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 87 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:33', '2014-06-12 10:01:36', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 09:59:33', 87)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 43 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 87 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (43, '2014-06-12 09:59:33', 42, '111', 86, 'sina', 'connected', '5048115199', '2014-06-12 09:59:33', 87)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 86 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (42, '2014-06-12 09:59:33', 43, '5048115199', 87, 'sina', 'matched', '111', '2014-06-12 09:59:33', 86)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1763ms
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('bLZqaFCWrq3zmVp6YyJ8', '2014-06-12 09:59:33', '2014-06-12 09:59:33', 'test1@email.com', '$2a$10$cRyseq3AhOMLQCku3oboEuXqnqoH2Uv20ycHle8KPhwOXvrMXmb7i', 'user', 'pending', '2014-06-12 09:59:33')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:33', '2014-06-12 09:59:33', 88, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uv3adx6p', 88)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:33', 'sina', 'test1', '111', '111', '2014-06-12 09:59:33', 88)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 44 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 88 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (44, '2014-06-12 09:59:33', 44, '111', 88, 'sina', 'connected', '111', '2014-06-12 09:59:33', 88)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 88 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (44, '2014-06-12 09:59:33', 44, '111', 88, 'sina', 'matched', '111', '2014-06-12 09:59:33', 88)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.6ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$zc.XbtcOlZLz4P1VvG3cgeaJ2ATZ0VYO9Jvi6Jo6uAbbsxALLz9Z2@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dRkMizUcYPqRKDyNsVEM', '2014-06-12 09:59:37', '2014-06-12 09:59:37', 'u$2a$10$zc.XbtcOlZLz4P1VvG3cgeaJ2ATZ0VYO9Jvi6Jo6uAbbsxALLz9Z2@fake-email.com', '$2a$10$iqegzFfyoJotgF4ZM2q4auyUOxEg8UwcqMJ9qypsHlTvj75mNYT4K', 'user', 'pending', '2014-06-12 09:59:37')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:38', '2014-06-12 09:59:38', 89, 20)
  [1m[36mSQL (34.1ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ucfvmesw', 89)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 89 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:38', '2014-06-12 10:01:41', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 09:59:38', 89)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 45 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 89 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.6ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (45, '2014-06-12 09:59:38', 44, '111', 88, 'sina', 'connected', '5048115199', '2014-06-12 09:59:38', 89)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 88 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (44, '2014-06-12 09:59:38', 45, '5048115199', 89, 'sina', 'matched', '111', '2014-06-12 09:59:38', 88)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 4279ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('bCzsbBYYwGsdVC7G49Bs', '2014-06-12 09:59:38', '2014-06-12 09:59:38', 'test1@email.com', '$2a$10$sdXH5zlXlRRH0lJT6JHV4uNOv1/vnitxeKH22VIzUoidEHIm9XDz.', 'user', 'pending', '2014-06-12 09:59:38')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:38', '2014-06-12 09:59:38', 90, 20)
  [1m[36mSQL (26.6ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uk87nkzv', 90)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:38', 'sina', 'test1', '111', '111', '2014-06-12 09:59:38', 90)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 46 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 90 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (46, '2014-06-12 09:59:38', 46, '111', 90, 'sina', 'connected', '111', '2014-06-12 09:59:38', 90)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 90 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (46, '2014-06-12 09:59:38', 46, '111', 90, 'sina', 'matched', '111', '2014-06-12 09:59:38', 90)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 11126ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('QAPByDPJJy3HwtqqoumF', '2014-06-12 09:59:49', '2014-06-12 09:59:49', 'test1@email.com', '$2a$10$CDZLhFY/AteMS4SlDHyBxuJwCAUOTIDgicji9S.E2tJaXQUrj7Sfa', 'user', 'pending', '2014-06-12 09:59:49')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:49', '2014-06-12 09:59:49', 91, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uuq275nk', 91)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (10.1ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:49', 'sina', 'test1', '111', '111', '2014-06-12 09:59:49', 91)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 47 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 91 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (47, '2014-06-12 09:59:49', 47, '111', 91, 'sina', 'connected', '111', '2014-06-12 09:59:49', 91)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 91 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (47, '2014-06-12 09:59:49', 47, '111', 91, 'sina', 'matched', '111', '2014-06-12 09:59:49', 91)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"weibo_access_token"=>"396E3E0FBFB2635428F4CAEAD986F1B8", "client_id"=>"100330589", "open_id"=>"049005BE2B6A55FEF9E95D08E22DCF58", "expires_in_sec"=>"123"}
Completed 401 Unauthorized in 1073ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('pQLGakwp26pz9WTdDrmV', '2014-06-12 09:59:50', '2014-06-12 09:59:50', 'test1@email.com', '$2a$10$4l4m6eoyvnF5Uj6JYCoEoegZ42C6zMwtVq5CbYFv4ViVMSddNWP6S', 'user', 'pending', '2014-06-12 09:59:50')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 09:59:50', '2014-06-12 09:59:50', 92, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('us2v89ff', 92)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 09:59:50', 'sina', 'test1', '111', '111', '2014-06-12 09:59:50', 92)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 48 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 92 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (13.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (48, '2014-06-12 09:59:50', 48, '111', 92, 'sina', 'connected', '111', '2014-06-12 09:59:50', 92)[0m
  [1m[35mSQL (0.3ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 92 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (48, '2014-06-12 09:59:50', 48, '111', 92, 'sina', 'matched', '111', '2014-06-12 09:59:50', 92)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 803ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zDfQTxs9HPis4hBjms49', '2014-06-12 10:00:19', '2014-06-12 10:00:19', 'test1@email.com', '$2a$10$ogYH67yUVpNFWAEF3Hf5UeWAwptU7qt0xtAwu0zo3Qs/ac3Q372qC', 'user', 'pending', '2014-06-12 10:00:19')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:00:19', '2014-06-12 10:00:19', 93, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ugx5sby2', 93)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:00:19', 'sina', 'test1', '111', '111', '2014-06-12 10:00:19', 93)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 49 LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 93 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (49, '2014-06-12 10:00:19', 49, '111', 93, 'sina', 'connected', '111', '2014-06-12 10:00:19', 93)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 93 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (49, '2014-06-12 10:00:19', 49, '111', 93, 'sina', 'matched', '111', '2014-06-12 10:00:19', 93)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$O3FVWCpNB.1Q0no37qDFo.4czrAgaYiBCR2dX1oxK9uZsSv/67gzO@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('bDxc3TN9M62WkSPoq8sU', '2014-06-12 10:00:20', '2014-06-12 10:00:20', 'u$2a$10$O3FVWCpNB.1Q0no37qDFo.4czrAgaYiBCR2dX1oxK9uZsSv/67gzO@fake-email.com', '$2a$10$PUwxyw1.5Egad5Q9MO7cfO5fyhs3677ZGVJ.55xfivSmOKbJbbXI2', 'user', 'pending', '2014-06-12 10:00:20')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:00:21', '2014-06-12 10:00:21', 94, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uzw45tm8', 94)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 94 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (38.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:00:21', '2014-06-12 10:02:24', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:00:21', 94)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 50 LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 94 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (50, '2014-06-12 10:00:21', 49, '111', 93, 'sina', 'connected', '5048115199', '2014-06-12 10:00:21', 94)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 93 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (49, '2014-06-12 10:00:21', 50, '5048115199', 94, 'sina', 'matched', '111', '2014-06-12 10:00:21', 93)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1529ms
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('NHrxCwLHaEKKqHy7x1Vd', '2014-06-12 10:00:58', '2014-06-12 10:00:58', 'test1@email.com', '$2a$10$Hg40mXZo3WNGbnAiKzhvNeiNKgCxAFtHPLGNmgoWCdKf9bLMe2b2.', 'user', 'pending', '2014-06-12 10:00:58')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:00:58', '2014-06-12 10:00:58', 95, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubtxj4u9', 95)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:00:58', 'sina', 'test1', '111', '111', '2014-06-12 10:00:58', 95)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 51 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 95 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.6ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (51, '2014-06-12 10:00:58', 51, '111', 95, 'sina', 'connected', '111', '2014-06-12 10:00:58', 95)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 95 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (51, '2014-06-12 10:00:58', 51, '111', 95, 'sina', 'matched', '111', '2014-06-12 10:00:58', 95)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.6ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$/88C/bJlQXH6kmkAW0sHGOvmxmzyp4tb5uIV1S9zFJtudjW5vSCb6@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yLnDPwV6WfaM3Fi4nzbx', '2014-06-12 10:00:59', '2014-06-12 10:00:59', 'u$2a$10$/88C/bJlQXH6kmkAW0sHGOvmxmzyp4tb5uIV1S9zFJtudjW5vSCb6@fake-email.com', '$2a$10$p7iZax3JH5a7ETQJswB.POQUzX98YrFqqgZsquxQU4AQKIgVIHOTu', 'user', 'pending', '2014-06-12 10:00:59')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:00:59', '2014-06-12 10:00:59', 96, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u3vxjf3s', 96)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 96 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (35.7ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:00:59', '2014-06-12 10:03:02', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:00:59', 96)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 52 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 96 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (52, '2014-06-12 10:01:00', 51, '111', 95, 'sina', 'connected', '5048115199', '2014-06-12 10:01:00', 96)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 95 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (51, '2014-06-12 10:01:00', 52, '5048115199', 96, 'sina', 'matched', '111', '2014-06-12 10:01:00', 95)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1610ms
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('d4Zr9zDubcwYPHkYyzeP', '2014-06-12 10:01:21', '2014-06-12 10:01:21', 'test1@email.com', '$2a$10$rA8DZuuNgJLYjYIf2lfyu.oeN3rro7CwPmtc2MXDjnMIRO2FffsAS', 'user', 'pending', '2014-06-12 10:01:21')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:01:21', '2014-06-12 10:01:21', 97, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u68gjmb8', 97)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:01:21', 'sina', 'test1', '111', '111', '2014-06-12 10:01:21', 97)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 53 LIMIT 1
  [1m[36mCorgi::User Load (0.6ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 97 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (53, '2014-06-12 10:01:21', 53, '111', 97, 'sina', 'connected', '111', '2014-06-12 10:01:21', 97)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 97 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (53, '2014-06-12 10:01:21', 53, '111', 97, 'sina', 'matched', '111', '2014-06-12 10:01:21', 97)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$QxgVtDOWVND.iGjqZ7q9l.6C2WmARHz9NEcCzVe7qud1Qb7G0tdsK@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('TqzJdpfEigizHcMxSDWG', '2014-06-12 10:01:22', '2014-06-12 10:01:22', 'u$2a$10$QxgVtDOWVND.iGjqZ7q9l.6C2WmARHz9NEcCzVe7qud1Qb7G0tdsK@fake-email.com', '$2a$10$p.XfDDX3P/edpELvY7pK.eSqzov8pv9FuRoBehKGqeD81JPao2RPe', 'user', 'pending', '2014-06-12 10:01:22')[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:01:22', '2014-06-12 10:01:22', 98, 20)
  [1m[36mSQL (37.7ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uyywcwyn', 98)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 98 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:01:22', '2014-06-12 10:03:25', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:01:22', 98)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 54 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 98 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (54, '2014-06-12 10:01:22', 53, '111', 97, 'sina', 'connected', '5048115199', '2014-06-12 10:01:22', 98)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 97 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (53, '2014-06-12 10:01:22', 54, '5048115199', 98, 'sina', 'matched', '111', '2014-06-12 10:01:22', 97)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1260ms
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('XL21TptuPoztVA1Zp4Lk', '2014-06-12 10:02:32', '2014-06-12 10:02:32', 'test1@email.com', '$2a$10$0npV.SoZTSEc6kKHysZ5/eqiVTePaO/.au0HL7svdvQn1Z29uX4.q', 'user', 'pending', '2014-06-12 10:02:32')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:02:32', '2014-06-12 10:02:32', 99, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uw3zhv72', 99)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:02:32', 'sina', 'test1', '111', '111', '2014-06-12 10:02:32', 99)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 55 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 99 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (55, '2014-06-12 10:02:32', 55, '111', 99, 'sina', 'connected', '111', '2014-06-12 10:02:32', 99)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 99 LIMIT 1
  [1m[36mSQL (7.5ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (55, '2014-06-12 10:02:32', 55, '111', 99, 'sina', 'matched', '111', '2014-06-12 10:02:32', 99)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$CnxNjTVHQf306JehHrnwhuNhj6/qvoneSOIh3ECi4eargSAu/UcxS@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('rp8xsqxbGzyZzp8hbPV3', '2014-06-12 10:02:33', '2014-06-12 10:02:33', 'u$2a$10$CnxNjTVHQf306JehHrnwhuNhj6/qvoneSOIh3ECi4eargSAu/UcxS@fake-email.com', '$2a$10$xari8.Aavd.LzI3t/1WUGeaDFu6o9FQAjUY78haac5Uw8n6SJXSgW', 'user', 'pending', '2014-06-12 10:02:33')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:02:33', '2014-06-12 10:02:33', 100, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('umref3gj', 100)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 100 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:02:33', '2014-06-12 10:04:36', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:02:33', 100)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 56 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 100 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (56, '2014-06-12 10:02:33', 55, '111', 99, 'sina', 'connected', '5048115199', '2014-06-12 10:02:33', 100)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 99 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (55, '2014-06-12 10:02:33', 56, '5048115199', 100, 'sina', 'matched', '111', '2014-06-12 10:02:33', 99)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1274ms
  [1m[36m (19.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('RQLaoxnpeuqQoancFmMF', '2014-06-12 10:03:03', '2014-06-12 10:03:03', 'test1@email.com', '$2a$10$Ab8OzOFHubW.w9fH7hu4jOeXscDmvw9/7XxUPvieBtf6YUgds/mIG', 'user', 'pending', '2014-06-12 10:03:03')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:03:03', '2014-06-12 10:03:03', 101, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubttdkmz', 101)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:03:03', 'sina', 'test1', '111', '111', '2014-06-12 10:03:03', 101)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 57 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 101 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (57, '2014-06-12 10:03:03', 57, '111', 101, 'sina', 'connected', '111', '2014-06-12 10:03:03', 101)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 101 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (57, '2014-06-12 10:03:03', 57, '111', 101, 'sina', 'matched', '111', '2014-06-12 10:03:03', 101)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$H58vaVbQ6Gvh.128WEs1FO.F810xW6YYGuvle.sRmNsSX/EigEM8W@fake-email.com' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('1t1zVucaUyqaz6pPUq7y', '2014-06-12 10:03:04', '2014-06-12 10:03:04', 'u$2a$10$H58vaVbQ6Gvh.128WEs1FO.F810xW6YYGuvle.sRmNsSX/EigEM8W@fake-email.com', '$2a$10$H21Rq8etF/Ny6nFZ0JhOCu0P6Fq0SyNnUfqVIgR8cJa4FmL0x3/be', 'user', 'pending', '2014-06-12 10:03:04')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:03:04', '2014-06-12 10:03:04', 102, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u23d7fub', 102)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 102 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (40.0ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:03:04', '2014-06-12 10:05:07', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:03:04', 102)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 58 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 102 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (58, '2014-06-12 10:03:04', 57, '111', 101, 'sina', 'connected', '5048115199', '2014-06-12 10:03:04', 102)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 101 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (57, '2014-06-12 10:03:04', 58, '5048115199', 102, 'sina', 'matched', '111', '2014-06-12 10:03:04', 101)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1362ms
  [1m[36m (13.8ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('8Zf6xhgpJKnYDc496Nqz', '2014-06-12 10:03:47', '2014-06-12 10:03:47', 'test1@email.com', '$2a$10$04ZpYSUsQ13FDLcxOzIMvO0M.3l.vPhk8G7mgsciUg4QkgbhR98Xm', 'user', 'pending', '2014-06-12 10:03:47')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:03:47', '2014-06-12 10:03:47', 103, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u3vqmtc9', 103)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:03:47', 'sina', 'test1', '111', '111', '2014-06-12 10:03:47', 103)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 59 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 103 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.6ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (59, '2014-06-12 10:03:47', 59, '111', 103, 'sina', 'connected', '111', '2014-06-12 10:03:47', 103)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 103 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (59, '2014-06-12 10:03:47', 59, '111', 103, 'sina', 'matched', '111', '2014-06-12 10:03:47', 103)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$UNnpTqwdYP9df9hNvXHGXeX1mx3BATsu7iBa3vdp0IenbvxTwkxXa@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('7kbbGpoiVy58SFQv4JBY', '2014-06-12 10:03:50', '2014-06-12 10:03:50', 'u$2a$10$UNnpTqwdYP9df9hNvXHGXeX1mx3BATsu7iBa3vdp0IenbvxTwkxXa@fake-email.com', '$2a$10$dVnr9S6hEJTRWSaxpOLTce2h8aQaF7AeccNyxXrGkt1IseLQqJAw6', 'user', 'pending', '2014-06-12 10:03:50')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:03:50', '2014-06-12 10:03:50', 104, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('um3dhzev', 104)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 104 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:03:50', '2014-06-12 10:05:53', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:03:50', 104)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 60 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 104 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (60, '2014-06-12 10:03:50', 59, '111', 103, 'sina', 'connected', '5048115199', '2014-06-12 10:03:50', 104)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 103 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (59, '2014-06-12 10:03:50', 60, '5048115199', 104, 'sina', 'matched', '111', '2014-06-12 10:03:50', 103)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 2847ms
  [1m[36m (19.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('mEzsKvoTJNK7dRZc4d22', '2014-06-12 10:04:25', '2014-06-12 10:04:25', 'test1@email.com', '$2a$10$8jAHwc7xFPBDqFOaY.HvceSlLz/7WCgT.WovVkR8/t79Y1JjLbO3y', 'user', 'pending', '2014-06-12 10:04:25')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:04:25', '2014-06-12 10:04:25', 105, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uw9zjgtc', 105)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:04:25', 'sina', 'test1', '111', '111', '2014-06-12 10:04:25', 105)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 61 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 105 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (61, '2014-06-12 10:04:25', 61, '111', 105, 'sina', 'connected', '111', '2014-06-12 10:04:25', 105)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 105 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (61, '2014-06-12 10:04:25', 61, '111', 105, 'sina', 'matched', '111', '2014-06-12 10:04:25', 105)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$cchnFBCn.S81laFYwPhhO.hLEgHl3F6MxNFhsARQPJeFR6FkBaHnS@fake-email.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('spmFDTd6mZxS18L7DG2d', '2014-06-12 10:04:26', '2014-06-12 10:04:26', 'u$2a$10$cchnFBCn.S81laFYwPhhO.hLEgHl3F6MxNFhsARQPJeFR6FkBaHnS@fake-email.com', '$2a$10$A1MLNsp660/bfIps2LjA1ejvPY.AML20jf7PdjeBFQME.wCYp57IG', 'user', 'pending', '2014-06-12 10:04:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:04:26', '2014-06-12 10:04:26', 106, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uau4nyjj', 106)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 106 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:04:26', '2014-06-12 10:06:29', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:04:26', 106)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 62 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 106 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (62, '2014-06-12 10:04:26', 61, '111', 105, 'sina', 'connected', '5048115199', '2014-06-12 10:04:26', 106)
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 105 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (61, '2014-06-12 10:04:26', 62, '5048115199', 106, 'sina', 'matched', '111', '2014-06-12 10:04:26', 105)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1735ms
  [1m[36m (16.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 10:04:44', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 10:04:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"0"}
  [1m[36mCorgi::BuildVersion Load (0.4ms)[0m  [1mSELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1[0m
  Rendered /Users/daneil/APP/corgi/app/views/corgi/v1/build_versions/index.json.rabl (1.8ms)
Completed 200 OK in 51ms (Views: 39.6ms | ActiveRecord: 0.4ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 10:04:44', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 10:04:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"2"}
  [1m[36mCorgi::BuildVersion Load (0.2ms)[0m  [1mSELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1[0m
Completed 200 OK in 2ms (Views: 1.3ms | ActiveRecord: 0.2ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('94iy34xJmB1zdWrgrPjJ', '2014-06-12 10:04:53', '2014-06-12 10:04:53', 'test@test.com', '$2a$10$xt7lk9VqxnhU25S4tOHV6ulvEDPKMZch0JSDANnWR0SaLsdAY.DLu', 'user', 'pending', '2014-06-12 10:04:53')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:04:53', '2014-06-12 10:04:53', 107, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u4mvm5q3', 107)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 10:04:53', '127.0.0.1', '2014-06-12 10:04:53', 107)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 10:04:53', '127.0.0.1', '2014-06-12 10:04:53', 107)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::FeedbacksController#index as JSON
  Parameters: {"token"=>"94iy34xJmB1zdWrgrPjJ"}
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '94iy34xJmB1zdWrgrPjJ' LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '94iy34xJmB1zdWrgrPjJ' LIMIT 1[0m
  [1m[35mCorgi::Feedback Load (0.5ms)[0m  SELECT `corgi_feedbacks`.* FROM `corgi_feedbacks`  WHERE `corgi_feedbacks`.`user_id` = 107  ORDER BY created_at DESC
  Rendered /Users/daneil/APP/corgi/app/views/corgi/v1/feedbacks/index.json.rabl (3.7ms)
Completed 200 OK in 57ms (Views: 35.7ms | ActiveRecord: 1.2ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dYCBKBVrXRBNrwkitYQZ', '2014-06-12 10:05:35', '2014-06-12 10:05:35', 'test1@email.com', '$2a$10$q1FClleXpm.VKYQlQ7Np4.WTJVjBBJ.G6jJGKf871wniqDXqvSU3e', 'user', 'pending', '2014-06-12 10:05:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:35', '2014-06-12 10:05:35', 108, 20)[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uf799kwe', 108)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('PxAFwJy88Djghg7uzzYp', '2014-06-12 10:05:35', '2014-06-12 10:05:35', 'test2@email.com', '$2a$10$WrqYXUNSERRivURlgUzkAOWv/jkxKevQdi69XM/1qt.uXs3jE1cNK', 'user', 'pending', '2014-06-12 10:05:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:35', '2014-06-12 10:05:35', 109, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxq42dut', 109)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('FDFQdmZzcosMckyzyrpm', '2014-06-12 10:05:35', '2014-06-12 10:05:35', 'test3@email.com', '$2a$10$g/kptk6/hdwsLBxD/0jTWuukXGcZqBeT3FM1YxYKL1H4/2moqR8bq', 'user', 'pending', '2014-06-12 10:05:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:35', '2014-06-12 10:05:35', 110, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ufgztkfy', 110)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::FriendsController#import as JSON
  Parameters: {"token"=>"dYCBKBVrXRBNrwkitYQZ", "friends"=>"     test2@email.com, test3@email.com,     change@test.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'dYCBKBVrXRBNrwkitYQZ' LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IN ('test2@email.com', 'test3@email.com', 'change@test.com')[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'dYCBKBVrXRBNrwkitYQZ' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:05:35', 109, '2014-06-12 10:05:35', 108)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:05:35', 110, '2014-06-12 10:05:35', 108)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  Rendered /Users/daneil/APP/corgi/app/views/corgi/v1/friends/import.json.rabl (1.8ms)
Completed 200 OK in 86ms (Views: 35.1ms | ActiveRecord: 17.0ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('HR9HDnkw54HDt2ZdspsG', '2014-06-12 10:05:35', '2014-06-12 10:05:35', 'test1@email.com', '$2a$10$kYFoDz6wwBh9dJoJ6UeLa.NAkv06paRF5RNxMd/SmI/TW7YgNEb6G', 'user', 'pending', '2014-06-12 10:05:35')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:35', '2014-06-12 10:05:35', 111, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u2bxyrks', 111)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('X7rTksfoxPx39Xj4jB24', '2014-06-12 10:05:35', '2014-06-12 10:05:35', 'test2@email.com', '$2a$10$crBS06CWkqPgqnIkX9JHO.B5whz.klpqZhGRFAkzVx8K/1b44I1DG', 'user', 'pending', '2014-06-12 10:05:35')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:35', '2014-06-12 10:05:35', 112, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u3pybqqg', 112)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('rsuadpCTeicYqsqcfM4v', '2014-06-12 10:05:35', '2014-06-12 10:05:35', 'test3@email.com', '$2a$10$MCkWO/7e2bhGVcs3DmJ0jOx2.e510fafIywg6xQt0eKec5bF45zjO', 'user', 'pending', '2014-06-12 10:05:35')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 113, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ukxp6c4e', 113)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `provider`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:05:36', 112, 'code', '2014-06-12 10:05:36', 111)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::FriendsController#index as JSON
  Parameters: {"token"=>"HR9HDnkw54HDt2ZdspsG"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'HR9HDnkw54HDt2ZdspsG' LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'HR9HDnkw54HDt2ZdspsG' LIMIT 1[0m
  [1m[35mCorgi::Friend Load (0.3ms)[0m  SELECT `corgi_friends`.* FROM `corgi_friends`  WHERE `corgi_friends`.`user_id` = 111
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 112 LIMIT 1[0m
Completed 200 OK in 9ms (Views: 6.2ms | ActiveRecord: 1.2ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('carnyCAyusqeCems9pxn', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test1@email.com', '$2a$10$de9Dvf31s3aYmSuyDarglOihnYT7HWY13tyajR1YFz6gNKWAP.BCW', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 114, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uv3bch6r', 114)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('jVpynJs5DaSrEVzBewNs', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test2@email.com', '$2a$10$hUODNh69rrsCYLUx8ut5hOI7yLQAnsazLpZ7rpf7dWS9CPEClOreO', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 115, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ug89dv3p', 115)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('et48brAASPiaAx58N1Rs', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test3@email.com', '$2a$10$jMBY./3a5ao/IKpj2XFy1eUaLHicMfnYkIAyMGAniwh8QMpPUmNV2', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 116, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uq9dgpzt', 116)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (42.0ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('sG4uKK3Zd21qvvS2sKdk', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test1@email.com', '$2a$10$OVnK7opzNjq17CLMK7VQuO7phcnpfC9KV0B05z2M3JhclR5BKMSry', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 117, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uvs3yzqn', 117)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('vBqwThhaFkVS2zAUKz8p', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test2@email.com', '$2a$10$yB4dQxssvJnFHeNPg4tsQOt8B02MasuzzGmN5NvgNQojIsJaJWTPO', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 118, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u8xavznt', 118)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('HZtZNtUP65YLjxwgafZH', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test3@email.com', '$2a$10$8b7kvj4S.t7k3KoyMdu8xemh9ssZFC5mGmEilCq5dPeVVqhXvpJya', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 119, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ug6zgama', 119)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCorgi::UserCode Load (0.4ms)[0m  SELECT  `corgi_user_codes`.* FROM `corgi_user_codes`  WHERE `corgi_user_codes`.`user_id` = 118 LIMIT 1
Processing by Corgi::V1::FriendsController#create as JSON
  Parameters: {"token"=>"sG4uKK3Zd21qvvS2sKdk", "code"=>"u8xavznt"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'sG4uKK3Zd21qvvS2sKdk' LIMIT 1[0m
  [1m[35mCorgi::UserCode Load (0.2ms)[0m  SELECT  `corgi_user_codes`.* FROM `corgi_user_codes`  WHERE `corgi_user_codes`.`code` = 'u8xavznt' LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 118 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'sG4uKK3Zd21qvvS2sKdk' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `provider`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:05:36', 118, 'code', '2014-06-12 10:05:36', 117)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 12ms (Views: 3.8ms | ActiveRecord: 1.3ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('RQAQZ1FZs736sySgvoSC', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test1@email.com', '$2a$10$jJMlTIy3KcTz34F4qtjqq..Wo8GysAg7.468ZgoxF8WqL2bLwrNfy', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 120, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ued2m2ve', 120)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('2mwN15ar6pBJ73F45Nb1', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test2@email.com', '$2a$10$hSHSGb9VSGrhlzbUO4fIJeA400l//4NlKlB1Oc/9AFsYU7/ralcky', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 121, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u6sddaxy', 121)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('p5w7JeWaeoQU4BRpW1KQ', '2014-06-12 10:05:36', '2014-06-12 10:05:36', 'test3@email.com', '$2a$10$OaCTs/PAI9vFpE0UXeqLqOlVtaC0ozF.UTeuREBzqBMg9ZCFwHuGW', 'user', 'pending', '2014-06-12 10:05:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:36', '2014-06-12 10:05:36', 122, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uakam2pa', 122)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::FriendsController#create as JSON
  Parameters: {"token"=>"RQAQZ1FZs736sySgvoSC", "email"=>"test2@email.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'RQAQZ1FZs736sySgvoSC' LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test2@email.com' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'RQAQZ1FZs736sySgvoSC' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `provider`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:05:36', 121, 'email', '2014-06-12 10:05:36', 120)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 1.1ms | ActiveRecord: 1.1ms)
  [1m[35m (33.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('dRiQwRrEyTAY5Ly9CQ5H', '2014-06-12 10:05:54', '2014-06-12 10:05:54', 'test1@test.com', '$2a$10$c1y2st0XTryCnQ6OvXofheBvjzttFKoJzY2UBTd/a9Mgt1PHl5od.', 'user', 'pending', '2014-06-12 10:05:54')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:54', '2014-06-12 10:05:54', 123, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('upurvmx3', 123)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>nil}
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1
Completed 500 Internal Server Error in 8ms
  [1m[36m (7.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('FfdTwcwDpnuKRRZ9soSc', '2014-06-12 10:05:54', '2014-06-12 10:05:54', 'test2@test.com', '$2a$10$4j.Q9PBP2PmVUV/ZQkCKWu1vVA/sh5KkHblmqmWm41qAojgmpoV/e', 'user', 'pending', '2014-06-12 10:05:54')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:54', '2014-06-12 10:05:54', 124, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u5xwk74q', 124)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"daneil@daneil.com"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'daneil@daneil.com' LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (17.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('feFgfzcppYeUPTS1HQup', '2014-06-12 10:05:54', '2014-06-12 10:05:54', 'test3@test.com', '$2a$10$1QrPbt92MNdkjxH0Ow3G6udJnnEehLscHuPdqAmgRtFQMjysqRXPO', 'user', 'pending', '2014-06-12 10:05:54')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:54', '2014-06-12 10:05:54', 125, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('us82ex33', 125)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test3@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test3@test.com' LIMIT 1
Completed 500 Internal Server Error in 78ms
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test4@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Ciaj9Lf9AxXM68M1jQ3p', '2014-06-12 10:05:54', '2014-06-12 10:05:54', 'test4@test.com', '$2a$10$iLQOzPRXmKGup12aGpH.6OGYC2wmVbzLXg3QrkvWaA868qwcALqGu', 'user', 'pending', '2014-06-12 10:05:54')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:54', '2014-06-12 10:05:54', 126, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('up7cdrgq', 126)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test4@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test4@test.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test4@test.com' AND `corgi_users`.`id` != 126) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `corgi_users` SET `authentication_token` = 'syiFrdKKSgQNZff743pG', `updated_at` = '2014-06-12 10:05:55' WHERE `corgi_users`.`id` = 126
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 115ms (Views: 35.7ms | ActiveRecord: 1.5ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('xk1GBNBxknuWyRW3Jbaw', '2014-06-12 10:05:55', '2014-06-12 10:05:55', 'test5@test.com', '$2a$10$TxcRcOJ9SYUxG8O4WQyEDe9jUqWakleXvizMvW70/qLHVxtQiTPjy', 'user', 'pending', '2014-06-12 10:05:55')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:55', '2014-06-12 10:05:55', 127, 20)[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uebex7cx', 127)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test5@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test5@test.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.6ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test5@test.com' AND `corgi_users`.`id` != 127) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `authentication_token` = 'Ry4xkzF5X73yJynnSt2x', `updated_at` = '2014-06-12 10:05:55' WHERE `corgi_users`.`id` = 127[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 79ms (Views: 1.4ms | ActiveRecord: 1.6ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zDEt9yyRUGCdqbyT828C', '2014-06-12 10:05:55', '2014-06-12 10:05:55', 'test6@test.com', '$2a$10$9CWSTzH1IQNWsGyoPh/3xuhgueAvrTso0LqfhWZUQqw/yQI13QP1O', 'user', 'pending', '2014-06-12 10:05:55')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:05:55', '2014-06-12 10:05:55', 128, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ub6h9ydw', 128)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test6@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test6@test.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test6@test.com' AND `corgi_users`.`id` != 128) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `corgi_users` SET `authentication_token` = 'azJgHVtdGH9ndq6YAq9D', `updated_at` = '2014-06-12 10:05:55' WHERE `corgi_users`.`id` = 128
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 79ms (Views: 1.6ms | ActiveRecord: 1.4ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('1rizaLpCkBSExD2JjzNC', '2014-06-12 10:06:07', '2014-06-12 10:06:07', 'test@test.com', '$2a$10$NRQfHwN5Eqh7z5WKQHcW.OZ5jWkdWvTrKdcvykT6iKgsLvc4v6DRW', 'user', 'pending', '2014-06-12 10:06:07')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:07', '2014-06-12 10:06:07', 129, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uu6gt4mu', 129)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:07', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:06:07', 129)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"password_request"=>"[FILTERED]", "change_password"=>"[FILTERED]"}
  [1m[36mCorgi::PasswordRequest Load (0.3ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.5ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 129 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test@test.com' AND `corgi_users`.`id` != 129) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$XYKpEkREvV8/yk6tLpZU1uhG0XWJgGNiy9XfhfubWqLoGMV7Vhd.K', `updated_at` = '2014-06-12 10:06:07' WHERE `corgi_users`.`id` = 129[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_password_requests` SET `state` = 'finished', `updated_at` = '2014-06-12 10:06:07' WHERE `corgi_password_requests`.`id` = 15
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  Rendered text template (0.0ms)
Completed 200 OK in 108ms (Views: 8.6ms | ActiveRecord: 2.5ms)
  [1m[35m (11.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('L1BDSq1q4F5GRduowMcy', '2014-06-12 10:06:07', '2014-06-12 10:06:07', 'test@test.com', '$2a$10$XmlfbpG8nErqR8Ml/oTdpu46OYbZbtMNxwPWcKd9NW3BLjPFFuyXe', 'user', 'pending', '2014-06-12 10:06:07')
  [1m[36mSQL (16.4ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:07', '2014-06-12 10:06:07', 130, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uzvbuxmp', 130)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:07', 'test@test.com', '127.0.0.1', 'finished', 'qweqweqwe', '2014-06-12 10:06:07', 130)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('2D9dzPVKxexFyYqHApR3', '2014-06-12 10:06:07', '2014-06-12 10:06:07', 'test@test.com', '$2a$10$MxAuij0fvyz0RoIfasH5NeB7EmU6ApCbrj9WTKrk0jhBKMsdui/o.', 'user', 'pending', '2014-06-12 10:06:07')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:07', '2014-06-12 10:06:07', 131, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uf2vgd64', 131)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:07', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:06:07', 131)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[35m (47.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('JxAEnC49pmaa9JDr3gYc', '2014-06-12 10:06:07', '2014-06-12 10:06:07', 'test@test.com', '$2a$10$GICL3yg2Pl83Uvhzj1yTbuInpANdLhqkocvfN1gMwqQGkF8mfEId.', 'user', 'pending', '2014-06-12 10:06:07')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:07', '2014-06-12 10:06:07', 132, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uf5w86h9', 132)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"email"=>"test@test.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (43.5ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:07', 'test@test.com', '0.0.0.0', 'pending', 'EP83HXdfQpeSy35szvZ2', '2014-06-12 10:06:07', 132)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m

Corgi::UserMailer#send_email: processed outbound mail in 34.3ms

Sent mail to test@test.com (8.8ms)
Date: Thu, 12 Jun 2014 18:06:08 +0800
From: yumu01@163.com
To: test@test.com
Message-ID: <53997b90a7be_2ded8082dbf84576f@daneil.local.mail>
Subject: Welcome
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
  </head>
  <body>
    <p>
      To change the password, just follow this link: http://gts.api.engine.com:3001/api/v1/password_requests/new_password/?token=EP83HXdfQpeSy35szvZ2.
    </p>
    <p>Thanks for use  our web!</p>
  </body>
</html>
Completed 200 OK in 97ms (Views: 0.3ms | ActiveRecord: 44.1ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('fqgaVqMextx9urD9XtsM', '2014-06-12 10:06:08', '2014-06-12 10:06:08', 'test@test.com', '$2a$10$9iUMPpK8yjvQ0bpSGNScbexmp.mgyaYyX7BRZnUeQpC0x7Ih7/oby', 'user', 'pending', '2014-06-12 10:06:08')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:08', '2014-06-12 10:06:08', 133, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ue5bkxjs', 133)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:08', 'g@g.com', '127.0.0.1', 'pending', '2014-06-12 10:06:08', 133)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"password_request"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (4.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('8nJBFyK5akBzSh99qTti', '2014-06-12 10:06:08', '2014-06-12 10:06:08', 'test@test.com', '$2a$10$Tx3e2.OYAvaSDVzB2KVtBOgale7Nom7XS43f46Kc9gvU8qQXtg7Ky', 'user', 'pending', '2014-06-12 10:06:08')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:08', '2014-06-12 10:06:08', 134, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u4d33hkm', 134)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (41.8ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('4UUpszAshbzHJhhkyjab', '2014-06-12 10:06:08', '2014-06-12 10:06:08', 'test@test.com', '$2a$10$ZXIGB4E6Nj6z0QgXOPCR0OpBPJUowgmlKp0aGzB2MjRV2zuVpQ2X.', 'user', 'pending', '2014-06-12 10:06:08')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:08', '2014-06-12 10:06:08', 135, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uhaycb9a', 135)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:08', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:06:08', 135)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qqqqqqqq"}
  [1m[36mCorgi::PasswordRequest Load (0.4ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qqqqqqqq' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (10.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('bdLTZckE7ws9UydMfpb7', '2014-06-12 10:06:08', '2014-06-12 10:06:08', 'test@test.com', '$2a$10$SCFff1TyffJ1WSdXaPOmZ.nS3IJfXaPAPnIfiHuNEsYG5fpqZzrH.', 'user', 'pending', '2014-06-12 10:06:08')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:08', '2014-06-12 10:06:08', 136, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwtrw78h', 136)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:06:08', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:06:08', 136)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qweqweqwe"}
  [1m[36mCorgi::PasswordRequest Load (0.3ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1[0m
  [1m[35mCorgi::PasswordRequest Load (0.2ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1
Completed 200 OK in 7ms (Views: 5.5ms | ActiveRecord: 0.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('SwxCwqGdxQbWD72dHXzb', '2014-06-12 10:06:30', '2014-06-12 10:06:30', 'test1@test.com', '$2a$10$3WthXEeTHvRJ8Fob9di2Re9Z.52naCIMzdHJDaLku04yGb6QTR02W', 'user', 'pending', '2014-06-12 10:06:30')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:31', '2014-06-12 10:06:31', 137, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u35jb2cm', 137)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"SwxCwqGdxQbWD72dHXzb", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'SwxCwqGdxQbWD72dHXzb' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test1@test.com' AND `corgi_users`.`id` != 137) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$lKKHPknDS6x3CCPJEPVG6u5hN7s1RMBR/cY4VWHgpC9sBqLOHpvf.', `updated_at` = '2014-06-12 10:06:31' WHERE `corgi_users`.`id` = 137[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  Rendered text template (0.0ms)
Completed 200 OK in 166ms (Views: 7.0ms | ActiveRecord: 1.6ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('ofuHqCu5eWvR6cyvNM9k', '2014-06-12 10:06:31', '2014-06-12 10:06:31', 'test2@test.com', '$2a$10$HAT4nEIMsoinozoKXn/l8OwspjyN9R9Rcc67cazpq0DCI8XrVdYOu', 'user', 'pending', '2014-06-12 10:06:31')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:31', '2014-06-12 10:06:31', 138, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9d9t5st', 138)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"ofuHqCu5eWvR6cyvNM9k", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'ofuHqCu5eWvR6cyvNM9k' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test2@test.com' AND `corgi_users`.`id` != 138) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$sUtNSStFoQe97F/5KVVcVOynC64Zbp/9l10rII9a/JFGOMXa8ENra', `updated_at` = '2014-06-12 10:06:31' WHERE `corgi_users`.`id` = 138
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 149ms (Views: 0.3ms | ActiveRecord: 1.5ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('2KqyBmvuA9PPhexxuyqz', '2014-06-12 10:06:31', '2014-06-12 10:06:31', 'test3@test.com', '$2a$10$um5OJuntOZxfTTGWRb6rfOHhhPBWzkStgR95p3bs4JVyhe20IIRoy', 'user', 'pending', '2014-06-12 10:06:31')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:31', '2014-06-12 10:06:31', 139, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9pwqjqn', 139)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"2KqyBmvuA9PPhexxuyqz", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '2KqyBmvuA9PPhexxuyqz' LIMIT 1
Completed 500 Internal Server Error in 77ms
  [1m[36m (41.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test4@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('6YesZtT1y8NNZc3HNbmS', '2014-06-12 10:06:31', '2014-06-12 10:06:31', 'test4@test.com', '$2a$10$9X56W6mOQYlDH4HZNdJNwOIBkxcck5yWtX0cdICCTRPp/XGgZM/Gq', 'user', 'pending', '2014-06-12 10:06:31')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:31', '2014-06-12 10:06:31', 140, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uep9qxzx', 140)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"6YesZtT1y8NNZc3HNbmS", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '6YesZtT1y8NNZc3HNbmS' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test4@test.com' AND `corgi_users`.`id` != 140) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$vrGar1YLQexAwbRSrv4jY.Cp9rCYVKFTw9hHthDlP86jYK5f61nNW', `updated_at` = '2014-06-12 10:06:31' WHERE `corgi_users`.`id` = 140
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 155ms (Views: 0.5ms | ActiveRecord: 1.4ms)
  [1m[35m (11.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yv4KQ5xkymyd1Hx29Y5S', '2014-06-12 10:06:31', '2014-06-12 10:06:31', 'test@test.com', '$2a$10$UAvBMnadMomtax0pomX9Ju9ZC3kYaBVtVjgv7O3dVmGf.r6bRs/D6', 'user', 'pending', '2014-06-12 10:06:31')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:31', '2014-06-12 10:06:31', 141, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uk5sd4q2', 141)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 115ms (Views: 33.8ms | ActiveRecord: 1.6ms)
  [1m[35m (8.7ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('QNKswNkBp8kXjZtzC99s', '2014-06-12 10:06:32', '2014-06-12 10:06:32', 'test@test.com', '$2a$10$bbwWrvUscxqm5p5HHjq.kuTaiMaQQlCLsTFv8sFPOWHIrj2VETBCK', 'user', 'pending', '2014-06-12 10:06:32')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:32', '2014-06-12 10:06:32', 142, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ujnu6ed4', 142)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 83ms (Views: 1.3ms | ActiveRecord: 1.4ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('WyXX7sfFz2uxsxZ4xfpF', '2014-06-12 10:06:32', '2014-06-12 10:06:32', 'test@test.com', '$2a$10$iocreqcBpv4teyRAqfTj6.007U6hdvs9UzbsiphMUwYZ/IW05cGEa', 'user', 'pending', '2014-06-12 10:06:32')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:32', '2014-06-12 10:06:32', 143, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uajjdzdm', 143)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 85ms (Views: 1.7ms | ActiveRecord: 1.4ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('kynvYDwp5jy4ikyzG45F', '2014-06-12 10:06:32', '2014-06-12 10:06:32', 'test5@test.com', '$2a$10$zTXcSEkSBJtdkoEovhb.V.FtsF4tXmk3R3jPF93zlVyqMvBrA/08i', 'user', 'pending', '2014-06-12 10:06:32')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:32', '2014-06-12 10:06:32', 144, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ud9c3ppm', 144)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test5@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 5ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '1233.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('F3xigPpydN9f5yQiMry2', '2014-06-12 10:06:59', '2014-06-12 10:06:59', 'test1@test.com', '$2a$10$U6wnjA8X1NHepdr.XyzVE.Jpgjz1M2vTaPwj.kCmKl6ocAI9HSikS', 'user', 'pending', '2014-06-12 10:06:59')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:59', '2014-06-12 10:06:59', 145, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uj5gtcwx', 145)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"F3xigPpydN9f5yQiMry2", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'F3xigPpydN9f5yQiMry2' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test1@test.com' AND `corgi_users`.`id` != 145) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$OXF8eYE4olnXjmjy4kBG6OQvvv..jadcXH2K1WGMSflwyCQyWQf3i', `updated_at` = '2014-06-12 10:06:59' WHERE `corgi_users`.`id` = 145[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  Rendered text template (0.0ms)
Completed 200 OK in 167ms (Views: 7.1ms | ActiveRecord: 1.6ms)
  [1m[36m (4.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('piQLZRyguNMDwcXp4iwF', '2014-06-12 10:06:59', '2014-06-12 10:06:59', 'test2@test.com', '$2a$10$0sMT7mgr/hHMAG0CdibuYegmGpSBkMrlYlrQLpIQFcGfG2GamY9xK', 'user', 'pending', '2014-06-12 10:06:59')[0m
  [1m[35mSQL (12.7ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:06:59', '2014-06-12 10:06:59', 146, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uqmq7gtt', 146)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"piQLZRyguNMDwcXp4iwF", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'piQLZRyguNMDwcXp4iwF' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test2@test.com' AND `corgi_users`.`id` != 146) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$ZwqDFwSE1gY6EVOGcVZ8E.vRpZXZ2h7fXSH.qOowGzsKP69epdJ7m', `updated_at` = '2014-06-12 10:06:59' WHERE `corgi_users`.`id` = 146
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 150ms (Views: 0.5ms | ActiveRecord: 1.2ms)
  [1m[35m (12.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('RrgZgqDhsMxV7G6dNpiP', '2014-06-12 10:06:59', '2014-06-12 10:06:59', 'test3@test.com', '$2a$10$L0icpd08NNjCrGIhhJPc2uQ4X1UnJE1X/CjMpR5UC8Q6bBjyFLEq6', 'user', 'pending', '2014-06-12 10:06:59')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:00', '2014-06-12 10:07:00', 147, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxy6jt7d', 147)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"RrgZgqDhsMxV7G6dNpiP", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'RrgZgqDhsMxV7G6dNpiP' LIMIT 1
Completed 500 Internal Server Error in 73ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test4@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('GFStzZHNHJz4i1UrF32u', '2014-06-12 10:07:00', '2014-06-12 10:07:00', 'test4@test.com', '$2a$10$Cjd/LZ2NxHSPHrMW1jU46.k7eCCQBXQMWkMMyLwF/s0qpoHhG9316', 'user', 'pending', '2014-06-12 10:07:00')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:00', '2014-06-12 10:07:00', 148, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u3yhwbwc', 148)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"GFStzZHNHJz4i1UrF32u", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'GFStzZHNHJz4i1UrF32u' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test4@test.com' AND `corgi_users`.`id` != 148) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$RvKpXiX6lnUITLITZVpkzOUV50HZuzwGlZe4PQMFkj7C7mKQOuZBG', `updated_at` = '2014-06-12 10:07:00' WHERE `corgi_users`.`id` = 148
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 149ms (Views: 0.5ms | ActiveRecord: 1.2ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('xroqtYgqKVDrT9ayTw9u', '2014-06-12 10:07:00', '2014-06-12 10:07:00', 'test@test.com', '$2a$10$EcyohNnC0K.5G0w0.pBXGeA9oHYYyd6VsyeKNHmwgMtBfDpVAhLRe', 'user', 'pending', '2014-06-12 10:07:00')
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:00', '2014-06-12 10:07:00', 149, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('urnq8djw', 149)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 113ms (Views: 33.0ms | ActiveRecord: 1.6ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('YDKDLypoHiHeE72quQsK', '2014-06-12 10:07:00', '2014-06-12 10:07:00', 'test@test.com', '$2a$10$jDEoDyUWZC1PrJLGnucOB.fALgSPTnzypjq2PwQDV04o.yqvVJGsS', 'user', 'pending', '2014-06-12 10:07:00')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:00', '2014-06-12 10:07:00', 150, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uy6wb4sj', 150)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 86ms (Views: 2.1ms | ActiveRecord: 1.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('mtLZpVqXT7bxyxpxpf2n', '2014-06-12 10:07:00', '2014-06-12 10:07:00', 'test@test.com', '$2a$10$cOPcopfmv14YRcaU4d752eP/AJLhXkgPnjiDwdmGDpevayw4KSecy', 'user', 'pending', '2014-06-12 10:07:00')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:00', '2014-06-12 10:07:00', 151, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uw5jwa9k', 151)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 88ms (Views: 1.2ms | ActiveRecord: 1.1ms)
  [1m[35m (120.5ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('oZPrGGHyaeyFFSFET4fq', '2014-06-12 10:07:00', '2014-06-12 10:07:00', 'test5@test.com', '$2a$10$lmoXYm43/1RzlnPe8dAxRumFi1OEAdWmhsUakWcpJ3YrLUJhfGnvm', 'user', 'pending', '2014-06-12 10:07:00')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:00', '2014-06-12 10:07:00', 152, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u3aj6vuh', 152)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test5@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 5ms
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '1233.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('i88N6gFqrPcXDQPJvJZt', '2014-06-12 10:07:08', '2014-06-12 10:07:08', 'test1@email.com', '$2a$10$pczoVlmov1v60oTjAXbz6uoNJ8ezIgkUTJaZBd5axuto/rQ7sHU0W', 'user', 'pending', '2014-06-12 10:07:08')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:08', '2014-06-12 10:07:08', 153, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uhg9bmma', 153)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:07:08', 'sina', 'test1', '111', '111', '2014-06-12 10:07:08', 153)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 63 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 153 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (63, '2014-06-12 10:07:08', 63, '111', 153, 'sina', 'connected', '111', '2014-06-12 10:07:08', 153)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 153 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (63, '2014-06-12 10:07:08', 63, '111', 153, 'sina', 'matched', '111', '2014-06-12 10:07:08', 153)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$DxcTv0cJ626lOLF/ItJq6euc9Wa75IhAMmI9vgo1XCQZV13h8Yn8C@fake-email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('DdpgPETpjBo6PyB6QHPS', '2014-06-12 10:07:10', '2014-06-12 10:07:10', 'u$2a$10$DxcTv0cJ626lOLF/ItJq6euc9Wa75IhAMmI9vgo1XCQZV13h8Yn8C@fake-email.com', '$2a$10$2r7ShL1N1APxWqs8dghys.C8tveY4GsycOWl387fhY/z7qyDJZ02e', 'user', 'pending', '2014-06-12 10:07:10')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:07:10', '2014-06-12 10:07:10', 154, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uk9p92bw', 154)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 154 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:07:10', '2014-06-12 10:09:13', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:07:10', 154)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 64 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 154 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (41.5ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (64, '2014-06-12 10:07:10', 63, '111', 153, 'sina', 'connected', '5048115199', '2014-06-12 10:07:10', 154)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 153 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (63, '2014-06-12 10:07:10', 64, '5048115199', 154, 'sina', 'matched', '111', '2014-06-12 10:07:10', 153)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1710ms
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('4xwovWZAp2y1E6a9FVZ2', '2014-06-12 10:30:52', '2014-06-12 10:30:52', 'test1@email.com', '$2a$10$K78.u8ETBdlKg7F4OEwKIOG.VvYdyDN1maj84JVzTua686cWWiNIG', 'user', 'pending', '2014-06-12 10:30:52')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:30:52', '2014-06-12 10:30:52', 155, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('upt6se8j', 155)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:30:52', 'sina', 'test1', '111', '111', '2014-06-12 10:30:52', 155)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 65 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 155 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (65, '2014-06-12 10:30:52', 65, '111', 155, 'sina', 'connected', '111', '2014-06-12 10:30:52', 155)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 155 LIMIT 1
  [1m[36mSQL (20.4ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (65, '2014-06-12 10:30:52', 65, '111', 155, 'sina', 'matched', '111', '2014-06-12 10:30:52', 155)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.5ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$UggZdjERU1Qu6qSBWEJqq.bl0uq/mtwR8/RmGH/pouHS4SsMiYUvS@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('n6xD3bCGT7sGEAiHLpzq', '2014-06-12 10:30:54', '2014-06-12 10:30:54', 'u$2a$10$UggZdjERU1Qu6qSBWEJqq.bl0uq/mtwR8/RmGH/pouHS4SsMiYUvS@fake-email.com', '$2a$10$xNGAlCGhIuImyo0Nc1i5iOcXJ8Q4ikoX9/dSbT2YLVDxshLrac6CK', 'user', 'pending', '2014-06-12 10:30:54')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:30:54', '2014-06-12 10:30:54', 156, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u6z9f36s', 156)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 156 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:30:54', '2014-06-12 10:32:57', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:30:54', 156)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 66 LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 156 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (66, '2014-06-12 10:30:54', 65, '111', 155, 'sina', 'connected', '5048115199', '2014-06-12 10:30:54', 156)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 155 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (65, '2014-06-12 10:30:54', 66, '5048115199', 156, 'sina', 'matched', '111', '2014-06-12 10:30:54', 155)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 500 Internal Server Error in 1559ms
  [1m[36m (33.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Z66gJ4DspyJfRP9P43iF', '2014-06-12 10:31:52', '2014-06-12 10:31:52', 'test1@email.com', '$2a$10$9BFcYFAfUASRmeb0eqMq.erq4SYPgEBaZfwViWagbjCqc9hzCmVn2', 'user', 'pending', '2014-06-12 10:31:52')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:31:52', '2014-06-12 10:31:52', 157, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('us4zgu5t', 157)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:31:52', 'sina', 'test1', '111', '111', '2014-06-12 10:31:52', 157)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 67 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 157 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (67, '2014-06-12 10:31:52', 67, '111', 157, 'sina', 'connected', '111', '2014-06-12 10:31:52', 157)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 157 LIMIT 1
  [1m[36mSQL (13.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (67, '2014-06-12 10:31:52', 67, '111', 157, 'sina', 'matched', '111', '2014-06-12 10:31:52', 157)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends`[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$2HUPmJb1emRaI8pMHrkrAOBs7HVzckYrffMYap4148IgQkAYr2jUS@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('my9zzCp3ABcCnYL2LBCv', '2014-06-12 10:31:54', '2014-06-12 10:31:54', 'u$2a$10$2HUPmJb1emRaI8pMHrkrAOBs7HVzckYrffMYap4148IgQkAYr2jUS@fake-email.com', '$2a$10$xfdbaWMuzR15RfNwKw2e3.2BtPqSswFgtHqvVRpllrgX1Ifh.yLta', 'user', 'pending', '2014-06-12 10:31:54')[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:31:54', '2014-06-12 10:31:54', 158, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u2t4g8qa', 158)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 158 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (38.5ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:31:54', '2014-06-12 10:33:57', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:31:54', 158)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 68 LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 158 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (68, '2014-06-12 10:31:54', 67, '111', 157, 'sina', 'connected', '5048115199', '2014-06-12 10:31:54', 158)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 157 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (67, '2014-06-12 10:31:54', 68, '5048115199', 158, 'sina', 'matched', '111', '2014-06-12 10:31:54', 157)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  Rendered /Users/daneil/APP/corgi/app/views/corgi/v1/sessions/create.json.rabl (1.1ms)
Completed 200 OK in 1981ms (Views: 32.5ms | ActiveRecord: 43.2ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `corgi_friends`  WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`user_id` = 157[0m
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zjH4Rpu5baJjngyXAZSS', '2014-06-12 10:32:08', '2014-06-12 10:32:08', 'test1@email.com', '$2a$10$VNjTlBqHH/6m5fZgsUlLE.LpfCcyq4cO3jzILqeiGnG192A33atM2', 'user', 'pending', '2014-06-12 10:32:08')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:08', '2014-06-12 10:32:08', 159, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ueqatp3n', 159)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:08', 'sina', 'test1', '111', '111', '2014-06-12 10:32:08', 159)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 69 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 159 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (69, '2014-06-12 10:32:08', 69, '111', 159, 'sina', 'connected', '111', '2014-06-12 10:32:08', 159)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 159 LIMIT 1
  [1m[36mSQL (25.4ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (69, '2014-06-12 10:32:08', 69, '111', 159, 'sina', 'matched', '111', '2014-06-12 10:32:08', 159)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 2311ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('xx8vdqPLmC6QgEqXyjNv', '2014-06-12 10:32:10', '2014-06-12 10:32:10', 'test1@email.com', '$2a$10$fN5JVNeknG6IBz/7w73ZBuxeumQAc9FYFZajJ65hCtnVDpjA1sfxi', 'user', 'pending', '2014-06-12 10:32:10')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:10', '2014-06-12 10:32:10', 160, 20)
  [1m[36mSQL (19.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uhgyrxjd', 160)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:10', 'sina', 'test1', '111', '111', '2014-06-12 10:32:10', 160)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 70 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 160 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (70, '2014-06-12 10:32:10', 70, '111', 160, 'sina', 'connected', '111', '2014-06-12 10:32:10', 160)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 160 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (70, '2014-06-12 10:32:10', 70, '111', 160, 'sina', 'matched', '111', '2014-06-12 10:32:10', 160)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM `corgi_friends`
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1
  [1m[36mCorgi::User Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$1U9YkJBLm2Nqw1CL3p5YrOtuAGz5FZQeUPM/lsLKepBNvvVAtbThq@fake-email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('WFL71s2AnSip3sfq8nbp', '2014-06-12 10:32:12', '2014-06-12 10:32:12', 'u$2a$10$1U9YkJBLm2Nqw1CL3p5YrOtuAGz5FZQeUPM/lsLKepBNvvVAtbThq@fake-email.com', '$2a$10$IVrPX.kiSkGtF0sK4T4uhu6KcO.8SS7eE2YgNa7dX0TLiDVjY58AO', 'user', 'pending', '2014-06-12 10:32:12')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:12', '2014-06-12 10:32:12', 161, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ugbsdcj6', 161)
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 161 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1[0m
  [1m[35mSQL (42.7ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:12', '2014-06-12 10:34:15', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:32:12', 161)
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 71 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 161 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (71, '2014-06-12 10:32:12', 70, '111', 160, 'sina', 'connected', '5048115199', '2014-06-12 10:32:12', 161)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 160 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (70, '2014-06-12 10:32:12', 71, '5048115199', 161, 'sina', 'matched', '111', '2014-06-12 10:32:12', 160)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2057ms (Views: 35.7ms | ActiveRecord: 47.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `corgi_friends`  WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`user_id` = 160
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('QjZSruuezcExxP7VBgGu', '2014-06-12 10:32:12', '2014-06-12 10:32:12', 'test1@email.com', '$2a$10$uz4ZOgs/3/f0SdrARlNVx.HKJ44YaD7SVOl.9BDLNLiCw8vIAIS6i', 'user', 'pending', '2014-06-12 10:32:12')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:12', '2014-06-12 10:32:12', 162, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uaf4meuk', 162)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:12', 'sina', 'test1', '111', '111', '2014-06-12 10:32:12', 162)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 72 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 162 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (72, '2014-06-12 10:32:12', 72, '111', 162, 'sina', 'connected', '111', '2014-06-12 10:32:12', 162)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 162 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (72, '2014-06-12 10:32:12', 72, '111', 162, 'sina', 'matched', '111', '2014-06-12 10:32:12', 162)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$oggENgveDCw2PlNPa0tOrOi7xBL/RsQdXanQE3WrCQfIRiMWBLpzK@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yswDqnmfKaM6K7J4YLGK', '2014-06-12 10:32:14', '2014-06-12 10:32:14', 'u$2a$10$oggENgveDCw2PlNPa0tOrOi7xBL/RsQdXanQE3WrCQfIRiMWBLpzK@fake-email.com', '$2a$10$qTGyjPBqHqBnxBWHAA.JnOON1AMZ1ybQsrs0XE.fOjVUzftoco7.K', 'user', 'pending', '2014-06-12 10:32:14')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:14', '2014-06-12 10:32:14', 163, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uexzmmva', 163)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 163 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:14', '2014-06-12 10:34:17', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:32:14', 163)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 73 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 163 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (73, '2014-06-12 10:32:14', 72, '111', 162, 'sina', 'connected', '5048115199', '2014-06-12 10:32:14', 163)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 162 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (72, '2014-06-12 10:32:14', 73, '5048115199', 163, 'sina', 'matched', '111', '2014-06-12 10:32:14', 162)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 1254ms (Views: 1.2ms | ActiveRecord: 4.1ms)
  [1m[36m (35.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('p3mTCGtTufKebpowxpwz', '2014-06-12 10:32:23', '2014-06-12 10:32:23', 'test1@email.com', '$2a$10$BQ1yUC1yXHyuMUoKeEDJcODJJ6GoPLAyB2mTxe2q0pFGJJl6ahb6m', 'user', 'pending', '2014-06-12 10:32:23')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:23', '2014-06-12 10:32:23', 164, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('um9sm5u9', 164)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:23', 'sina', 'test1', '111', '111', '2014-06-12 10:32:23', 164)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 74 LIMIT 1
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 164 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (74, '2014-06-12 10:32:23', 74, '111', 164, 'sina', 'connected', '111', '2014-06-12 10:32:23', 164)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 164 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (74, '2014-06-12 10:32:23', 74, '111', 164, 'sina', 'matched', '111', '2014-06-12 10:32:23', 164)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 2592ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('ZN6GLWJ28LtSzKSrMc1S', '2014-06-12 10:32:26', '2014-06-12 10:32:26', 'test1@email.com', '$2a$10$CMuP3O7G8zpYe2sgQmbx/u6ZGYqUr7RYZxNBSLlgPYDvAYtGiqCJm', 'user', 'pending', '2014-06-12 10:32:26')[0m
  [1m[35mSQL (14.5ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:26', '2014-06-12 10:32:26', 165, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uvet94r7', 165)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:26', 'sina', 'test1', '111', '111', '2014-06-12 10:32:26', 165)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 75 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 165 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (75, '2014-06-12 10:32:26', 75, '111', 165, 'sina', 'connected', '111', '2014-06-12 10:32:26', 165)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 165 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (75, '2014-06-12 10:32:26', 75, '111', 165, 'sina', 'matched', '111', '2014-06-12 10:32:26', 165)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$w6wTFBpUuL4fm4BbE9MGr.ehUg9BT/Y/lgiB3Bg54.a7N9q2qYzQi@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('oFv7iR67xPSkBVWguMks', '2014-06-12 10:32:28', '2014-06-12 10:32:28', 'u$2a$10$w6wTFBpUuL4fm4BbE9MGr.ehUg9BT/Y/lgiB3Bg54.a7N9q2qYzQi@fake-email.com', '$2a$10$UbH1/cdHo9rCXTic6r/49u6mT.leztbBCuRJuTBzvJBDDxAsAMvoq', 'user', 'pending', '2014-06-12 10:32:28')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:28', '2014-06-12 10:32:28', 166, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9qdbegz', 166)[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 166 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (29.6ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:28', '2014-06-12 10:34:31', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:32:28', 166)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 76 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 166 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (76, '2014-06-12 10:32:28', 75, '111', 165, 'sina', 'connected', '5048115199', '2014-06-12 10:32:28', 166)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 165 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (75, '2014-06-12 10:32:28', 76, '5048115199', 166, 'sina', 'matched', '111', '2014-06-12 10:32:28', 165)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 1969ms (Views: 35.9ms | ActiveRecord: 33.7ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Ghs2FXDQpBewfgPhfCfB', '2014-06-12 10:32:28', '2014-06-12 10:32:28', 'test1@email.com', '$2a$10$MGMC2xpPniSTQvgm9/GOG.3PQvl6L2nZqQX72dFg7YkwISbGRgrHC', 'user', 'pending', '2014-06-12 10:32:28')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:28', '2014-06-12 10:32:28', 167, 20)
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('unse6685', 167)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:28', 'sina', 'test1', '111', '111', '2014-06-12 10:32:28', 167)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 77 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 167 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (77, '2014-06-12 10:32:28', 77, '111', 167, 'sina', 'connected', '111', '2014-06-12 10:32:28', 167)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.5ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 167 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (77, '2014-06-12 10:32:28', 77, '111', 167, 'sina', 'matched', '111', '2014-06-12 10:32:28', 167)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends`
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$uF9UqonYW.jqKfmOvnBKXOLh8UoZUU5v.CVZWXwNe63T5AJxL4V92@fake-email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('gxZaTXNzZzJsNDwFvDeK', '2014-06-12 10:32:29', '2014-06-12 10:32:29', 'u$2a$10$uF9UqonYW.jqKfmOvnBKXOLh8UoZUU5v.CVZWXwNe63T5AJxL4V92@fake-email.com', '$2a$10$s9t7UvVIGCyS3jKmc/ztyerN3eDh3Idq.xoEAapO9UqzHkq7Sc33y', 'user', 'pending', '2014-06-12 10:32:29')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:29', '2014-06-12 10:32:29', 168, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubhxpmja', 168)
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 168 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:29', '2014-06-12 10:34:32', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:32:29', 168)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 78 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 168 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'
  [1m[36mSQL (37.6ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (78, '2014-06-12 10:32:29', 77, '111', 167, 'sina', 'connected', '5048115199', '2014-06-12 10:32:29', 168)[0m
  [1m[35mSQL (0.4ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 167 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (77, '2014-06-12 10:32:29', 78, '5048115199', 168, 'sina', 'matched', '111', '2014-06-12 10:32:29', 167)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 1415ms (Views: 1.7ms | ActiveRecord: 42.1ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM `corgi_friends`  WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`user_id` = 167
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('oBJ5Zib274JRHVEFg7ts', '2014-06-12 10:32:29', '2014-06-12 10:32:29', 'test1@email.com', '$2a$10$xptbaRyL.XsTxuiXpncaBu3c.bY2yr5ogCKLbn4HUU22mO923pNJK', 'user', 'pending', '2014-06-12 10:32:29')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:29', '2014-06-12 10:32:29', 169, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u2c5qxvs', 169)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:29', 'sina', 'test1', '111', '111', '2014-06-12 10:32:29', 169)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 79 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 169 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (79, '2014-06-12 10:32:29', 79, '111', 169, 'sina', 'connected', '111', '2014-06-12 10:32:29', 169)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 169 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (79, '2014-06-12 10:32:29', 79, '111', 169, 'sina', 'matched', '111', '2014-06-12 10:32:29', 169)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"weibo_access_token"=>"396E3E0FBFB2635428F4CAEAD986F1B8", "client_id"=>"100330589", "open_id"=>"049005BE2B6A55FEF9E95D08E22DCF58", "expires_in_sec"=>"123"}
Completed 401 Unauthorized in 1716ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[35m (13.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('XvVZ1WZX2yyhipW7yyo8', '2014-06-12 10:32:31', '2014-06-12 10:32:31', 'test1@email.com', '$2a$10$Tmta2iVMIjbOWbXvYJl9MO.XfJ8BPrL6AHkdslfJuPTA.HuZqcuUW', 'user', 'pending', '2014-06-12 10:32:31')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:32:31', '2014-06-12 10:32:31', 170, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uhcrvwqj', 170)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:32:31', 'sina', 'test1', '111', '111', '2014-06-12 10:32:31', 170)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 80 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 170 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (80, '2014-06-12 10:32:31', 80, '111', 170, 'sina', 'connected', '111', '2014-06-12 10:32:31', 170)
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 170 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (80, '2014-06-12 10:32:31', 80, '111', 170, 'sina', 'matched', '111', '2014-06-12 10:32:31', 170)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 1259ms (Views: 0.3ms | ActiveRecord: 0.0ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('jZEZ8siWRy96op8yVpX3', '2014-06-12 10:33:23', '2014-06-12 10:33:23', 'test1@test.com', '$2a$10$tkP7R1IRhEsoj/UY9C9Wf.KxGdM9dpR4kXHiavQfCSdkXIh614wzC', 'user', 'pending', '2014-06-12 10:33:23')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:23', '2014-06-12 10:33:23', 171, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u83jv2w7', 171)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"jZEZ8siWRy96op8yVpX3", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.5ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'jZEZ8siWRy96op8yVpX3' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test1@test.com' AND `corgi_users`.`id` != 171) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$.gM9C4DG2ePGLOT2ZRYZ8uolVlhZzXncECcaVHnZ8i5LXu/Yesn96', `updated_at` = '2014-06-12 10:33:23' WHERE `corgi_users`.`id` = 171[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  Rendered text template (0.0ms)
Completed 200 OK in 169ms (Views: 8.9ms | ActiveRecord: 1.7ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('2ptRg6VCXbXA4CHsHRqg', '2014-06-12 10:33:23', '2014-06-12 10:33:23', 'test2@test.com', '$2a$10$bNH8SQ9qjxtl6VTHw4hm8eeWdczggayXga7KLrNLNbGHNS.rO8Zky', 'user', 'pending', '2014-06-12 10:33:23')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:23', '2014-06-12 10:33:23', 172, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uydbyz43', 172)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"2ptRg6VCXbXA4CHsHRqg", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '2ptRg6VCXbXA4CHsHRqg' LIMIT 1[0m
Completed 500 Internal Server Error in 77ms
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('ezM1sJdHEQrxwWA6Spvc', '2014-06-12 10:33:23', '2014-06-12 10:33:23', 'test3@test.com', '$2a$10$IWinKSrSsHnBgW62m3D4kupZraojyD5stJn5WWlUHux2URL/Kqtbq', 'user', 'pending', '2014-06-12 10:33:23')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:23', '2014-06-12 10:33:23', 173, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwe9qvv7', 173)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"ezM1sJdHEQrxwWA6Spvc", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'ezM1sJdHEQrxwWA6Spvc' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test3@test.com' AND `corgi_users`.`id` != 173) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `corgi_users` SET `password` = '$2a$10$6x/d6Lv.lTxW9qFhhFdj4O2Kdalk.lNsqA.7p0aje6OLQ6SzUm196', `updated_at` = '2014-06-12 10:33:23' WHERE `corgi_users`.`id` = 173[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 150ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test4@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('diAY6zSU7Mvs3ykB8jKz', '2014-06-12 10:33:23', '2014-06-12 10:33:23', 'test4@test.com', '$2a$10$AdgmvbiUZ9qPwsyW.EpT1.YlrgWQucg9PW3vKaVhHXvjcVx4p3Jd.', 'user', 'pending', '2014-06-12 10:33:23')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:23', '2014-06-12 10:33:23', 174, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u4ecgbsj', 174)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#update_password as HTML
  Parameters: {"token"=>"diAY6zSU7Mvs3ykB8jKz", "password"=>"[FILTERED]", "new_password"=>"[FILTERED]", "captcha"=>"1122"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'diAY6zSU7Mvs3ykB8jKz' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test4@test.com' AND `corgi_users`.`id` != 174) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$O2xXOW9XV8oPurXxp/a.cOKhbdt7j6QkijRf4ben2pMuAGzkHbAp6', `updated_at` = '2014-06-12 10:33:24' WHERE `corgi_users`.`id` = 174
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 149ms (Views: 0.5ms | ActiveRecord: 1.2ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('JAqgcmkE8q8tFZoEEmpq', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test@test.com', '$2a$10$8OkAVLYAbwF9udKquPcTye9D.bDWGbmOW3VE0ew745frVR1w6rdEO', 'user', 'pending', '2014-06-12 10:33:24')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 175, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uue28nwn', 175)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 111ms (Views: 30.8ms | ActiveRecord: 1.3ms)
  [1m[35m (15.0ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('NTMEFypHCyyzd77AjTmR', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test@test.com', '$2a$10$20ywux4kabSEKvNnhiFWsuNokZvq1Xl5rMiZqysSQr7yV/lKc3eha', 'user', 'pending', '2014-06-12 10:33:24')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 176, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uek4msy7', 176)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 83ms (Views: 1.3ms | ActiveRecord: 1.4ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('ws77FpGqXVK8szmRktp7', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test@test.com', '$2a$10$Iz82J2.L1QDC3/UT2TbiIO0mZ5.86noMoWBejRnjK32iatwVHoTYm', 'user', 'pending', '2014-06-12 10:33:24')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 177, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uh4k7wg5', 177)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 82ms (Views: 1.3ms | ActiveRecord: 1.3ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '1233.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY '' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test5@test.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('YfYt48j8ZUgWV6QCevpi', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test6@test.com', '$2a$10$hscKrOuUd8DN7BJFnM8XCOHocDCHGFrO2vnxTCxt7Eb1vSql6fcPC', 'user', 'pending', '2014-06-12 10:33:24')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 178, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u6w98k62', 178)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::UsersController#create as JSON
  Parameters: {"email"=>"test6@test.com", "password"=>"[FILTERED]"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test6@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = 'test' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$kkyGET4.1ebof81BdeZ0z.66D6mNH8lWCp9EgKjec5EkYpagPpJOC@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('5Wzpoe6KB1VqDyCs4W8x', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'u$2a$10$kkyGET4.1ebof81BdeZ0z.66D6mNH8lWCp9EgKjec5EkYpagPpJOC@fake-email.com', '$2a$10$ywIDklL3eoGFQ3Hj88vBMeizwmDDP29D.v3B7x73b5jcaMuIDv5ne', 'user', 'pending', '2014-06-12 10:33:24')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 179, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwuphnv4', 179)[0m
  [1m[35mCorgi::Authentication Load (0.5ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 179 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:24', '2014-06-12 10:34:00', 'sina', 'test', '', '2014-06-12 10:33:24', 179)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 81 LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 179 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = ''[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('sXvzndyfrn2fvUwWspjt', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test1@email.com', '$2a$10$VfFH.bFjgZMddhb4GmJzVOnW6.ZI.SFrI4ScymsaYsbBr9H1nNF9G', 'user', 'pending', '2014-06-12 10:33:24')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 180, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uezfw2qy', 180)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zzcXSZi9vA5sG7DgHEhs', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test2@email.com', '$2a$10$XwxZPYZdCU4vVNOEdyvbGOF5eGs3iU5Jv80SXYjgHFmWK3ByqVy3q', 'user', 'pending', '2014-06-12 10:33:24')[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 181, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubm447kb', 181)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('4SSsQ3dtQ1pcDZm6P4nn', '2014-06-12 10:33:24', '2014-06-12 10:33:24', 'test3@email.com', '$2a$10$vg.HCcCjFAzweSSE7H6hkOVXzxDlFy2BtifwUVQW5ikgson.CxKw2', 'user', 'pending', '2014-06-12 10:33:24')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:24', '2014-06-12 10:33:24', 182, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ugun4bkv', 182)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::FriendsController#import as JSON
  Parameters: {"token"=>"sXvzndyfrn2fvUwWspjt", "friends"=>"     test2@email.com, test3@email.com,     change@test.com"}
  [1m[36mCorgi::User Load (0.4ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'sXvzndyfrn2fvUwWspjt' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IN ('test2@email.com', 'test3@email.com', 'change@test.com')
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'sXvzndyfrn2fvUwWspjt' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:24', 181, '2014-06-12 10:33:24', 180)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:24', 182, '2014-06-12 10:33:24', 180)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 23ms (Views: 4.6ms | ActiveRecord: 2.1ms)
  [1m[35m (28.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('oW8HU8sHjH4jAUwodNqb', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test1@email.com', '$2a$10$9FsaZ0mAw5VCKdMlIbAwEOkZFcAIFdbeb64PxbzUkF6qi6JI0t/la', 'user', 'pending', '2014-06-12 10:33:25')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 183, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uwymqrrp', 183)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('FDTcsVxpNNcoJ8NiAXzA', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test2@email.com', '$2a$10$EEhJpE2sAPHj4VDbpBobk.QEv.kdmWx1BNrI2UrQsn3O8lLj6raqm', 'user', 'pending', '2014-06-12 10:33:25')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 184, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('us74rey6', 184)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('3VaZAHqndKxbD2AqK2k2', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test3@email.com', '$2a$10$O7F7Lx7iXmm8PM.1QtwcEec7CZPoLs4tgo7TsZdmlPtPKkqHS6xGS', 'user', 'pending', '2014-06-12 10:33:25')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 185, 20)[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('usn7s8zb', 185)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `provider`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:25', 184, 'code', '2014-06-12 10:33:25', 183)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::FriendsController#index as JSON
  Parameters: {"token"=>"oW8HU8sHjH4jAUwodNqb"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'oW8HU8sHjH4jAUwodNqb' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'oW8HU8sHjH4jAUwodNqb' LIMIT 1
  [1m[36mCorgi::Friend Load (0.3ms)[0m  [1mSELECT `corgi_friends`.* FROM `corgi_friends`  WHERE `corgi_friends`.`user_id` = 183[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 184 LIMIT 1
Completed 200 OK in 8ms (Views: 5.7ms | ActiveRecord: 1.0ms)
  [1m[36m (36.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('mcSAyVfCKS3XRMz2bnpm', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test1@email.com', '$2a$10$Hr1FiUNN7a4ihsA/EYYGo.A/Bvo6uySzjjUq/0l6gNmw0oXZgrHnS', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 186, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ucagmg46', 186)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yx7GdwysPj7pM8svzptk', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test2@email.com', '$2a$10$h2OMTmBZey/uYfIUJ1eiwuRP1AF9WwsB1bDsU0ST8jZrq.me9XS0i', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 187, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u7zkbswv', 187)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('kUpPBbjC95NxrSEUrAVX', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test3@email.com', '$2a$10$KSdLZUkKCaG2SnOKQ1tD7OXo6g7qYWeV89UcnZqBydDXI5TdDdnlG', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 188, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u8ptp2x2', 188)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('8ZPEhpMyTmgovFDCse58', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test1@email.com', '$2a$10$CWe6FTVZEHYn5JZAysvVZetwCt1MSdfQ2qGHTbtDfLSuFjpEJoGmy', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 189, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u695qzwk', 189)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('KrbCy29mqbskZHndj7xH', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test2@email.com', '$2a$10$bMwFxm1l9eg3e1Vu44gpAurpGlblsS4FsO.VFyNienCAuwsYHVqT2', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 190, 20)
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubt8352q', 190)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('q6fFNiL9Ng72onoviSZf', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test3@email.com', '$2a$10$9oWM85Usk0ftpfeUEfTGTuE0xlppVqcXATHOjg2VrnlGXgCTsFfQi', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 191, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubxh9gnt', 191)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCorgi::UserCode Load (0.3ms)[0m  [1mSELECT  `corgi_user_codes`.* FROM `corgi_user_codes`  WHERE `corgi_user_codes`.`user_id` = 190 LIMIT 1[0m
Processing by Corgi::V1::FriendsController#create as JSON
  Parameters: {"token"=>"8ZPEhpMyTmgovFDCse58", "code"=>"ubt8352q"}
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '8ZPEhpMyTmgovFDCse58' LIMIT 1
  [1m[36mCorgi::UserCode Load (0.2ms)[0m  [1mSELECT  `corgi_user_codes`.* FROM `corgi_user_codes`  WHERE `corgi_user_codes`.`code` = 'ubt8352q' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 190 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = '8ZPEhpMyTmgovFDCse58' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `provider`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:25', 190, 'code', '2014-06-12 10:33:25', 189)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 11ms (Views: 3.7ms | ActiveRecord: 1.2ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Rp9TNRv8syQNTC2FJqZa', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test1@email.com', '$2a$10$v81jv.jY7HNVn.qYjNdYQ.4ZsJd/WhVfz33eBLMMi1TWj4d2DQT72', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 192, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('urfseghn', 192)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test2@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('3E8jqrx4LctB6x8Xmsx7', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test2@email.com', '$2a$10$WRkxbSkoUX8PiEfvBQ5SgO2kQnhZk/lTeO0SSF5bA/8aw4YDKDzg2', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:25', '2014-06-12 10:33:25', 193, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u5rt3544', 193)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test3@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('vedqxgEyGQizA6egsLUB', '2014-06-12 10:33:25', '2014-06-12 10:33:25', 'test3@email.com', '$2a$10$t24S40DeKv9QOQnoTNIPnOSPx3FSHpeapoVCc/F2STCuP5.d1DtJK', 'user', 'pending', '2014-06-12 10:33:25')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 194, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ut7pv6vw', 194)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::FriendsController#create as JSON
  Parameters: {"token"=>"Rp9TNRv8syQNTC2FJqZa", "email"=>"test2@email.com"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'Rp9TNRv8syQNTC2FJqZa' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test2@email.com' LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'Rp9TNRv8syQNTC2FJqZa' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`created_at`, `friend_user_id`, `provider`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:26', 193, 'email', '2014-06-12 10:33:26', 192)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 1.3ms | ActiveRecord: 1.2ms)
  [1m[36m (27.9ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 10:33:26', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 10:33:26')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"0"}
  [1m[35mCorgi::BuildVersion Load (0.3ms)[0m  SELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1
Completed 200 OK in 6ms (Views: 4.8ms | ActiveRecord: 0.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_build_versions` (`base_build`, `created_at`, `latest_build`, `latest_description`, `latest_url`, `latest_version`, `published_at`, `publisher`, `updated_at`) VALUES (1, '2014-06-12 10:33:26', 1, 'MyText', 'MyString', 'MyString', '2014-03-31 16:23:12', 1, '2014-06-12 10:33:26')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::BuildVersionsController#index as JSON
  Parameters: {"publisher"=>"1", "build"=>"2"}
  [1m[35mCorgi::BuildVersion Load (0.3ms)[0m  SELECT  `corgi_build_versions`.* FROM `corgi_build_versions`  WHERE `corgi_build_versions`.`publisher` = '1' LIMIT 1
Completed 200 OK in 2ms (Views: 1.2ms | ActiveRecord: 0.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('KV4TsHEz84HgMiY5khmB', '2014-06-12 10:33:26', '2014-06-12 10:33:26', 'test@test.com', '$2a$10$PaiQ28mEnfybXAaP0ACg6O4AanA1mivJk0dViMI/KnwJWZXmA6m9S', 'user', 'pending', '2014-06-12 10:33:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 195, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubyx4tz8', 195)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 10:33:26', '127.0.0.1', '2014-06-12 10:33:26', 195)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_feedbacks` (`contact`, `content`, `created_at`, `ip`, `updated_at`, `user_id`) VALUES ('test@test.com', 'feedback', '2014-06-12 10:33:26', '127.0.0.1', '2014-06-12 10:33:26', 195)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::FeedbacksController#index as JSON
  Parameters: {"token"=>"KV4TsHEz84HgMiY5khmB"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'KV4TsHEz84HgMiY5khmB' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`authentication_token` = 'KV4TsHEz84HgMiY5khmB' LIMIT 1
  [1m[36mCorgi::Feedback Load (0.4ms)[0m  [1mSELECT `corgi_feedbacks`.* FROM `corgi_feedbacks`  WHERE `corgi_feedbacks`.`user_id` = 195  ORDER BY created_at DESC[0m
Completed 200 OK in 10ms (Views: 5.7ms | ActiveRecord: 1.0ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test7@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('ze6YfT44yNasKqh2LTZn', '2014-06-12 10:33:26', '2014-06-12 10:33:26', 'test7@test.com', '$2a$10$I05sBml1uHcdj33sfVrP8.ojj1cCt.sLjZHVc5Rhn73q7R04dTOwy', 'user', 'pending', '2014-06-12 10:33:26')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 196, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u4sxv68e', 196)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test8@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('UYazeAyGdnjAk9U9ZeNL', '2014-06-12 10:33:26', '2014-06-12 10:33:26', 'test8@test.com', '$2a$10$B.sTKp2R9BvKB.gXb8LmN.9mIF3EGkBd8r3PyCXJsoaFVuw9SjREO', 'user', 'pending', '2014-06-12 10:33:26')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 197, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ucaey4p5', 197)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test8@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.4ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test8@test.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.5ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test8@test.com' AND `corgi_users`.`id` != 197) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `authentication_token` = 'T6yhPPzeacKA5kxqxGiv', `updated_at` = '2014-06-12 10:33:26' WHERE `corgi_users`.`id` = 197[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 83ms (Views: 3.9ms | ActiveRecord: 1.5ms)
  [1m[36m (24.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test9@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('c3s1ogWyDeDz8QygvEhF', '2014-06-12 10:33:26', '2014-06-12 10:33:26', 'test9@test.com', '$2a$10$qjO8CeWnyO54qsVrkDPgr.HZ15nV8PXJHVuOrWbaMRzRMI2Kdg7DW', 'user', 'pending', '2014-06-12 10:33:26')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 198, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uszdkuy3', 198)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test9@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test9@test.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test9@test.com' AND `corgi_users`.`id` != 198) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `corgi_users` SET `authentication_token` = 'YLkWYwxmqzKP1v98j3uL', `updated_at` = '2014-06-12 10:33:26' WHERE `corgi_users`.`id` = 198
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 80ms (Views: 1.8ms | ActiveRecord: 1.3ms)
  [1m[35m (49.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test10@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('mxwesndKtes3JZyxnsqz', '2014-06-12 10:33:26', '2014-06-12 10:33:26', 'test10@test.com', '$2a$10$smb2DMzSpatS2k/sxODQEeFz7SanVBCc8d0mwH0xA1CCeB0JfrlVC', 'user', 'pending', '2014-06-12 10:33:26')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 199, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uxc3ne2h', 199)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test10@test.com", "password"=>"[FILTERED]"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test10@test.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test10@test.com' AND `corgi_users`.`id` != 199) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_users` SET `authentication_token` = '2HkBZefYTXrFmm46WQwA', `updated_at` = '2014-06-12 10:33:26' WHERE `corgi_users`.`id` = 199[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 80ms (Views: 1.2ms | ActiveRecord: 1.4ms)
  [1m[36m (10.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test11@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('k8g3sp49Q5xyzCx9qiNF', '2014-06-12 10:33:26', '2014-06-12 10:33:26', 'test11@test.com', '$2a$10$UIrumHWwsZGodcJtxT7Kguz.VBAbNA21V0E9ri4vy.92ueWdyFf6i', 'user', 'pending', '2014-06-12 10:33:26')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:26', '2014-06-12 10:33:26', 200, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uk97tz7a', 200)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"test11@test.com", "password"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test11@test.com' LIMIT 1[0m
Completed 500 Internal Server Error in 73ms
  [1m[35m (2.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test12@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('NQp5Vc6YsPiUUZ4Fn1qA', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test12@test.com', '$2a$10$6NH7KV2FRyI.ayh0Hdp6A.eKALttGyarAC6HHx1tkCx1q3451gNou', 'user', 'pending', '2014-06-12 10:33:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 201, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u9jb7dw2', 201)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>"daneil@daneil.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'daneil@daneil.com' LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test13@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('yan4sFqVptCKE6JpcpXW', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test13@test.com', '$2a$10$n4TzezFzMuYQWOdZ.1k3du4g3CfFhxahsGCOhUt.4X0D02unkEj6S', 'user', 'pending', '2014-06-12 10:33:27')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 202, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uj4c32mb', 202)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::LoginsController#create as JSON
  Parameters: {"email"=>nil}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('8KU3rAVAFfsQP6od4UUB', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$njSI3LUNvBRGm6SQo4hYBePuouLyqLdaHHlYCIIDGzXpfu7U8no9y', 'user', 'pending', '2014-06-12 10:33:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 203, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('udzkq2bx', 203)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"email"=>"test@test.com"}
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test@test.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:27', 'test@test.com', '0.0.0.0', 'pending', '9341G1fVz5AcQefM1xdJ', '2014-06-12 10:33:27', 203)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m

Corgi::UserMailer#send_email: processed outbound mail in 33.9ms

Sent mail to test@test.com (9.2ms)
Date: Thu, 12 Jun 2014 18:33:27 +0800
From: yumu01@163.com
To: test@test.com
Message-ID: <539981f75b9bd_2fb08082dbf8430ba@daneil.local.mail>
Subject: Welcome
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
  </head>
  <body>
    <p>
      To change the password, just follow this link: http://gts.api.engine.com:3001/api/v1/password_requests/new_password/?token=9341G1fVz5AcQefM1xdJ.
    </p>
    <p>Thanks for use  our web!</p>
  </body>
</html>
Completed 200 OK in 52ms (Views: 0.5ms | ActiveRecord: 0.8ms)
  [1m[35m (8.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Ax3HUtUqdsMgADko4aK4', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$01FIqCBuGizfl5czee58dOP6R4CvBexdT1xJc12VZszSXgcioicL2', 'user', 'pending', '2014-06-12 10:33:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 204, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ujucctre', 204)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('g1rxFXhkbsVhX9DuYpnb', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$6r4N2JCc0S7tLhjgDkV7MONzfNJrrqp.A6if3NwJ0gIi3ia3FG6/q', 'user', 'pending', '2014-06-12 10:33:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 205, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u44zvmr3', 205)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:27', 'g@g.com', '127.0.0.1', 'pending', '2014-06-12 10:33:27', 205)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#create as JSON
  Parameters: {"password_request"=>"[FILTERED]"}
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 1ms
  [1m[35m (14.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('SpmsaRpMxwWDgm5yxwxp', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$xg11S3eRHQDv4ZW0ASIBOehOcmVKLMFieQknx0/oDjilouOYeVx9.', 'user', 'pending', '2014-06-12 10:33:27')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 206, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u7md499b', 206)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:27', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:33:27', 206)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qweqweqwe"}
  [1m[36mCorgi::PasswordRequest Load (0.3ms)[0m  [1mSELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1[0m
  [1m[35mCorgi::PasswordRequest Load (0.2ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1
Completed 200 OK in 8ms (Views: 6.3ms | ActiveRecord: 0.5ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('NGyhLe5sCfuTKiTHy8rG', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$PCIgxjede87QuT6cknQFzOSFHR2Ganc7i7k83N20aqXnL3x3uY41a', 'user', 'pending', '2014-06-12 10:33:27')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 207, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uavbw3fs', 207)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:27', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:33:27', 207)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#new_password as HTML
  Parameters: {"token"=>"qqqqqqqq"}
  [1m[35mCorgi::PasswordRequest Load (0.3ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qqqqqqqq' AND `corgi_password_requests`.`state` = 'pending' LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zvwG9YZBDRM8zySAS45R', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$vOw4huIAapMwp7fDK3YRKOOn1e7Wp7VtFJQ17DOt5Frdko.9IZxT2', 'user', 'pending', '2014-06-12 10:33:27')[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:27', '2014-06-12 10:33:27', 208, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('udmvzfj5', 208)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:27', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:33:27', 208)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"password_request"=>"[FILTERED]", "change_password"=>"[FILTERED]"}
  [1m[35mCorgi::PasswordRequest Load (0.3ms)[0m  SELECT  `corgi_password_requests`.* FROM `corgi_password_requests`  WHERE `corgi_password_requests`.`token` = 'qweqweqwe' LIMIT 1
  [1m[36mCorgi::User Load (0.3ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 208 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test@test.com' AND `corgi_users`.`id` != 208) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `corgi_users` SET `password` = '$2a$10$SLsHRdIM9lgWa0iyq9JIx.8vFYYXzSUTyGWDcIz5up.zd4AC3GD7C', `updated_at` = '2014-06-12 10:33:27' WHERE `corgi_users`.`id` = 208
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `corgi_password_requests` SET `state` = 'finished', `updated_at` = '2014-06-12 10:33:27' WHERE `corgi_password_requests`.`id` = 26[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 0.4ms | ActiveRecord: 2.4ms)
  [1m[36m (2.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('Jzj4n6fooRFFSPvWRUX4', '2014-06-12 10:33:27', '2014-06-12 10:33:27', 'test@test.com', '$2a$10$QVhqsqC/StbvaKL9lomph.iv3exCaOv7nzsh7omk4kbdUFVPlt4d.', 'user', 'pending', '2014-06-12 10:33:27')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:28', '2014-06-12 10:33:28', 209, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('upn9xuht', 209)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:28', 'test@test.com', '127.0.0.1', 'finished', 'qweqweqwe', '2014-06-12 10:33:28', 209)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[35m (17.4ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('ppQ4TczCoUiqR1LxY4eg', '2014-06-12 10:33:28', '2014-06-12 10:33:28', 'test@test.com', '$2a$10$HntVBSPH/CNj0BfXPrGvu.B0iyIRKJn24lRxv0ZZDLXzIkkcd5N9a', 'user', 'pending', '2014-06-12 10:33:28')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:28', '2014-06-12 10:33:28', 210, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uagcxx9t', 210)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_password_requests` (`created_at`, `email`, `ip`, `state`, `token`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:28', 'test@test.com', '127.0.0.1', 'pending', 'qweqweqwe', '2014-06-12 10:33:28', 210)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::PasswordRequestsController#change_password as JSON
  Parameters: {"token"=>"qweqweqwe", "change_password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 0ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.2ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zxNsqvb5kBPjtfj8Ahev', '2014-06-12 10:33:28', '2014-06-12 10:33:28', 'test1@email.com', '$2a$10$k1mgy2Mpuv9joJv9GqFnneL8LCUoggZ6tKCs8bvdkPVJ7baF1U1gS', 'user', 'pending', '2014-06-12 10:33:28')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:28', '2014-06-12 10:33:28', 211, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('udybqfsu', 211)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:28', 'sina', 'test1', '111', '111', '2014-06-12 10:33:28', 211)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 82 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 211 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (82, '2014-06-12 10:33:28', 82, '111', 211, 'sina', 'connected', '111', '2014-06-12 10:33:28', 211)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 211 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (82, '2014-06-12 10:33:28', 82, '111', 211, 'sina', 'matched', '111', '2014-06-12 10:33:28', 211)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 998ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('cqGEBNUBzjxvcosqkXxz', '2014-06-12 10:33:29', '2014-06-12 10:33:29', 'test1@email.com', '$2a$10$886TGiY087pTCX.HwZab3u0LlL.HTjupCS.HwYqBH7tGXupd1Zaui', 'user', 'pending', '2014-06-12 10:33:29')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:29', '2014-06-12 10:33:29', 212, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uja9cahn', 212)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:29', 'sina', 'test1', '111', '111', '2014-06-12 10:33:29', 212)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 83 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 212 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (83, '2014-06-12 10:33:29', 83, '111', 212, 'sina', 'connected', '111', '2014-06-12 10:33:29', 212)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 212 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (83, '2014-06-12 10:33:29', 83, '111', 212, 'sina', 'matched', '111', '2014-06-12 10:33:29', 212)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Corgi::V1::SessionsController#qq_callback as JSON
  Parameters: {"weibo_access_token"=>"396E3E0FBFB2635428F4CAEAD986F1B8", "client_id"=>"100330589", "open_id"=>"049005BE2B6A55FEF9E95D08E22DCF58", "expires_in_sec"=>"123"}
Completed 401 Unauthorized in 1277ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('pz5xT4SEdxLCHHCTCcXz', '2014-06-12 10:33:30', '2014-06-12 10:33:30', 'test1@email.com', '$2a$10$/bYp85G3cAclBlSSeJK2cObmi66icm7aWPb08aCzLlbpppz1TWhxu', 'user', 'pending', '2014-06-12 10:33:30')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:30', '2014-06-12 10:33:30', 213, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uhtkfbjv', 213)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:30', 'sina', 'test1', '111', '111', '2014-06-12 10:33:30', 213)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 84 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 213 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (84, '2014-06-12 10:33:30', 84, '111', 213, 'sina', 'connected', '111', '2014-06-12 10:33:30', 213)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.5ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 213 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (84, '2014-06-12 10:33:30', 84, '111', 213, 'sina', 'matched', '111', '2014-06-12 10:33:30', 213)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends`
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::Authentication Load (0.4ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$yZUUItkc1grpCunJhlNeAOJYb53TyknGOBpHsFOb6RZMpAxd57uaO@fake-email.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('F6MDysiVhekxgc83pYy8', '2014-06-12 10:33:32', '2014-06-12 10:33:32', 'u$2a$10$yZUUItkc1grpCunJhlNeAOJYb53TyknGOBpHsFOb6RZMpAxd57uaO@fake-email.com', '$2a$10$9lDnbc5A7L1DF6lsEV.T/.Z6eE4DOcP6j6RhGuNlCX5HrppclEyba', 'user', 'pending', '2014-06-12 10:33:32')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:32', '2014-06-12 10:33:32', 214, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uq4hrdu2', 214)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 214 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:32', '2014-06-12 10:35:35', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:33:32', 214)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 85 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 214 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (85, '2014-06-12 10:33:32', 84, '111', 213, 'sina', 'connected', '5048115199', '2014-06-12 10:33:32', 214)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 213 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (84, '2014-06-12 10:33:32', 85, '5048115199', 214, 'sina', 'matched', '111', '2014-06-12 10:33:32', 213)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 1791ms (Views: 4.1ms | ActiveRecord: 3.8ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `corgi_friends`  WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`user_id` = 213
  [1m[36m (16.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.4ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('2PosdYissTSpaizxFiyU', '2014-06-12 10:33:32', '2014-06-12 10:33:32', 'test1@email.com', '$2a$10$gZ.DdClU.sVGECErGSOHSOzy5Cf6lgRe8Het1WrxeYVDcY5B6vXY2', 'user', 'pending', '2014-06-12 10:33:32')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:32', '2014-06-12 10:33:32', 215, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ugmqky4p', 215)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:32', 'sina', 'test1', '111', '111', '2014-06-12 10:33:32', 215)
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 86 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 215 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (86, '2014-06-12 10:33:32', 86, '111', 215, 'sina', 'connected', '111', '2014-06-12 10:33:32', 215)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 215 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (86, '2014-06-12 10:33:32', 86, '111', 215, 'sina', 'matched', '111', '2014-06-12 10:33:32', 215)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"weibo_access_token"=>"2.00t34dVF0WNxEs763d92c0590oRzcf", "expires_in_sec"=>"123"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.4ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = '2.00t34dVF0WNxEs763d92c0590oRzcf' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'u$2a$10$vMaCI6Dr1gJazBcPHg3XT.1ch.ZAddiRP9hadfGmgGACziBSqcASK@fake-email.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('BCXRP1qqwhpwVxDxxqij', '2014-06-12 10:33:33', '2014-06-12 10:33:33', 'u$2a$10$vMaCI6Dr1gJazBcPHg3XT.1ch.ZAddiRP9hadfGmgGACziBSqcASK@fake-email.com', '$2a$10$8RAJtl1hV5qgEoz4ZMymie271it1lAJTNYt5wKTQP3cHxiobiDuIC', 'user', 'pending', '2014-06-12 10:33:33')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:34', '2014-06-12 10:33:34', 216, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uacvx46c', 216)[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`user_id` = 216 AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` = '5048115199' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `expired_at`, `provider`, `token`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:34', '2014-06-12 10:35:37', 'sina', '2.00t34dVF0WNxEs763d92c0590oRzcf', '5048115199', '2014-06-12 10:33:34', 216)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 87 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 216 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '5048115199'[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (87, '2014-06-12 10:33:34', 86, '111', 215, 'sina', 'connected', '5048115199', '2014-06-12 10:33:34', 216)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '5048115199'[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 215 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (86, '2014-06-12 10:33:34', 87, '5048115199', 216, 'sina', 'matched', '111', '2014-06-12 10:33:34', 215)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 1468ms (Views: 1.3ms | ActiveRecord: 4.0ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test1@email.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('hDkqygsaBk7A4skHn2TL', '2014-06-12 10:33:34', '2014-06-12 10:33:34', 'test1@email.com', '$2a$10$7NjSi2/P3651qatBcDKCeODXthbsBL437QbQUqqai4PExilqVgvee', 'user', 'pending', '2014-06-12 10:33:34')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:34', '2014-06-12 10:33:34', 217, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u82qqsch', 217)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:34', 'sina', 'test1', '111', '111', '2014-06-12 10:33:34', 217)
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 88 LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 217 LIMIT 1
  [1m[36mCorgi::Authentication Load (0.3ms)[0m  [1mSELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`uid` = '111'
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (88, '2014-06-12 10:33:34', 88, '111', 217, 'sina', 'connected', '111', '2014-06-12 10:33:34', 217)[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111'
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 217 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_friends` (`authentication_id`, `created_at`, `friend_authentication_id`, `friend_uid`, `friend_user_id`, `provider`, `state`, `uid`, `updated_at`, `user_id`) VALUES (88, '2014-06-12 10:33:34', 88, '111', 217, 'sina', 'matched', '111', '2014-06-12 10:33:34', 217)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Corgi::V1::SessionsController#sina_callback as JSON
  Parameters: {"token"=>"test"}
Completed 401 Unauthorized in 1045ms (Views: 0.4ms | ActiveRecord: 0.0ms)
  [1m[35m (41.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test14@test.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('FfJUMjpKeVmTmGYUkhCE', '2014-06-12 10:33:35', '2014-06-12 10:33:35', 'test14@test.com', '$2a$10$jtiIDh3jcP4B51Hulg6TGuxDLtUre4cGpVITISY93kE.RBoQgVA4y', 'user', 'pending', '2014-06-12 10:33:35')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:35', '2014-06-12 10:33:35', 218, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uechrvn2', 218)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCorgi::Account Load (0.4ms)[0m  SELECT  `corgi_accounts`.* FROM `corgi_accounts`  WHERE `corgi_accounts`.`user_id` = 218 LIMIT 1
  [1m[36m (9.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Exists (0.3ms)[0m  SELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test15@test.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('8qE5zn2uSMHxfHKbANC5', '2014-06-12 10:33:35', '2014-06-12 10:33:35', 'test15@test.com', '$2a$10$sHrgRnNNOhwD4lU/MnEJqO0bslKRfXrl5a2LI/tCZj..SNPL86Z6K', 'user', 'pending', '2014-06-12 10:33:35')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:35', '2014-06-12 10:33:35', 219, 20)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u35h9k8c', 219)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCorgi::UserCode Load (0.2ms)[0m  [1mSELECT  `corgi_user_codes`.* FROM `corgi_user_codes`  WHERE `corgi_user_codes`.`user_id` = 219 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test16@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('zy7Z3HsizAdjEKTezn1o', '2014-06-12 10:33:35', '2014-06-12 10:33:35', 'test16@test.com', '$2a$10$pNrlhwIVBjsXfPvxz7bO5uEruHQuIScayrdqhO18LUuPOiFlqfsdy', 'user', 'pending', '2014-06-12 10:33:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:35', '2014-06-12 10:33:35', 220, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u79j7pze', 220)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCorgi::User Load (0.3ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`email` = 'test16@test.com' LIMIT 1
  [1m[36mCorgi::User Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE (`corgi_users`.`email` = BINARY 'test16@test.com' AND `corgi_users`.`id` != 220) LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test17@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('eaKWGZbF3y2sYsRWuRzv', '2014-06-12 10:33:35', '2014-06-12 10:33:35', 'test17@test.com', '$2a$10$yizLxUYFzRUtpgksHjioMuOWU7pC.CvxRT4dlRvSQOlnjXS3wDIxq', 'user', 'pending', '2014-06-12 10:33:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:35', '2014-06-12 10:33:35', 221, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('ubmpdqpf', 221)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test18@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('qMdzCMsx7dnxnX1BLEqU', '2014-06-12 10:33:35', '2014-06-12 10:33:35', 'test18@test.com', '$2a$10$ya7X/HSfR2jj1HodimHKZOf8QCKsvBhfIQjdXYFunKf6cqzB.IfVC', 'user', 'pending', '2014-06-12 10:33:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:35', '2014-06-12 10:33:35', 222, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('u6n9x2kt', 222)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (25.6ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCorgi::User Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `corgi_users`  WHERE `corgi_users`.`email` = BINARY 'test19@test.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `corgi_users` (`authentication_token`, `authentication_token_updated_at`, `created_at`, `email`, `password`, `role`, `state`, `updated_at`) VALUES ('hMgnyGSkossy8C3fs4JF', '2014-06-12 10:33:35', '2014-06-12 10:33:35', 'test19@test.com', '$2a$10$5PdoCFxJA5RECHxmkLlrUujuGxb4xh5ROA/GqPU0uWZ/fTNfARoTO', 'user', 'pending', '2014-06-12 10:33:35')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `corgi_accounts` (`coins`, `created_at`, `updated_at`, `user_id`, `vcs`) VALUES (1700, '2014-06-12 10:33:36', '2014-06-12 10:33:36', 223, 20)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `corgi_user_codes` (`code`, `user_id`) VALUES ('uy2zpmdh', 223)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `corgi_authentications` (`created_at`, `provider`, `token`, `token_secret`, `uid`, `updated_at`, `user_id`) VALUES ('2014-06-12 10:33:36', 'sina', 'test', '111', '111111111', '2014-06-12 10:33:36', 223)[0m
  [1m[35mCorgi::Authentication Load (0.2ms)[0m  SELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`id` = 89 LIMIT 1
  [1m[36mCorgi::User Load (0.2ms)[0m  [1mSELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 223 LIMIT 1[0m
  [1m[35mCorgi::Authentication Load (0.3ms)[0m  SELECT `corgi_authentications`.* FROM `corgi_authentications` INNER JOIN `corgi_users` ON `corgi_users`.`id` = `corgi_authentications`.`user_id` WHERE (corgi_users.state <> 'inactive') AND `corgi_authentications`.`provider` = 'sina' AND `corgi_authentications`.`uid` IN (111, 222, 333)
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM `corgi_friends` WHERE `corgi_friends`.`provider` = 'sina' AND `corgi_friends`.`friend_uid` = '111111111'[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCorgi::Authentication Load (0.2ms)[0m  [1mSELECT  `corgi_authentications`.* FROM `corgi_authentications`  WHERE `corgi_authentications`.`token` = 'test' AND `corgi_authentications`.`provider` = 'sina' LIMIT 1[0m
  [1m[35mCorgi::User Load (0.2ms)[0m  SELECT  `corgi_users`.* FROM `corgi_users`  WHERE `corgi_users`.`id` = 223 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
